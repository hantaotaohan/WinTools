{"ns_map":["http://www.w3.org/1999/xhtml"],"tree":[0,[1,[1648],[1649],[1650],[1651]],[2,[3,[4,[1643,[1644,[1645,[1646],[1647]]]]],[5],[6],[7,[544],[545],[546,[1345],[1346,[1642]],[1347,[1641]],[1348,[1633,[1640]],[1634,[1639]],[1635,[1637],[1638]],[1636]],[1349,[1597],[1598,[1630],[1631],[1632]],[1599],[1600,[1625,[1626,[1627],[1628],[1629]]]],[1601,[1624]],[1602,[1618,[1619,[1620],[1621],[1622],[1623]]]],[1603,[1617]],[1604,[1612,[1613,[1614],[1615],[1616]]]],[1605],[1606,[1608,[1609,[1610],[1611]]]],[1607]],[1350,[1556],[1557,[1595],[1596]],[1558,[1591,[1592,[1593],[1594]]]],[1559,[1589],[1590]],[1560,[1587],[1588]],[1561,[1583,[1584,[1585],[1586]]]],[1562],[1563,[1579,[1580,[1581],[1582]]]],[1564,[1578]],[1565,[1574,[1575,[1576],[1577]]]],[1566],[1567,[1570,[1571,[1572],[1573]]]],[1568,[1569]]],[1351,[1530],[1531],[1532,[1551,[1552,[1553],[1554],[1555]]]],[1533,[1550]],[1534,[1546,[1547,[1548],[1549]]]],[1535,[1545]],[1536,[1541,[1542,[1543],[1544]]]],[1537,[1538],[1539],[1540]]],[1352,[1488],[1489,[1529]],[1490,[1525,[1526,[1527],[1528]]]],[1491,[1524]],[1492,[1520,[1521,[1522],[1523]]]],[1493,[1519]],[1494,[1515,[1516,[1517],[1518]]]],[1495,[1513],[1514]],[1496,[1509,[1510,[1511],[1512]]]],[1497],[1498,[1507],[1508]],[1499,[1503,[1504,[1505],[1506]]]],[1500,[1501],[1502]]],[1353,[1470],[1471,[1486],[1487]],[1472,[1483],[1484],[1485]],[1473,[1479,[1480,[1481],[1482]]]],[1474,[1477],[1478]],[1475,[1476]]],[1354,[1468],[1469]],[1355,[1456],[1457,[1467]],[1458,[1463,[1464,[1465],[1466]]]],[1459,[1460],[1461],[1462]]],[1356,[1433],[1434,[1455]],[1435,[1453],[1454]],[1436,[1449,[1450,[1451],[1452]]]],[1437,[1444],[1445],[1446],[1447],[1448]],[1438,[1439],[1440],[1441],[1442],[1443]]],[1357,[1373],[1374,[1432]],[1375,[1421],[1422,[1431]],[1423,[1427,[1428,[1429],[1430]]]],[1424,[1425],[1426]]],[1376,[1409],[1410,[1417],[1418],[1419],[1420]],[1411,[1413,[1414,[1415],[1416]]]],[1412]],[1377,[1397],[1398,[1407],[1408]],[1399,[1403,[1404,[1405],[1406]]]],[1400,[1401],[1402]]],[1378,[1379],[1380,[1392],[1393],[1394],[1395],[1396]],[1381,[1390],[1391]],[1382,[1386,[1387,[1388],[1389]]]],[1383,[1384],[1385]]]],[1358,[1359],[1360,[1372]],[1361,[1363,[1364,[1370,[1371]]],[1365,[1366,[1367],[1368],[1369]]]]],[1362]]],[547,[1155],[1156],[1157,[1344]],[1158,[1316],[1317],[1318,[1338,[1339,[1340],[1341],[1342],[1343]]]],[1319,[1335],[1336],[1337]],[1320,[1331,[1332,[1333],[1334]]]],[1321,[1330]],[1322,[1329]],[1323],[1324,[1325,[1326,[1327],[1328]]]]],[1159,[1265],[1266],[1267],[1268,[1310,[1311,[1312],[1313],[1314],[1315]]]],[1269,[1309]],[1270,[1308]],[1271,[1304,[1305,[1306],[1307]]]],[1272,[1299],[1300],[1301],[1302],[1303]],[1273,[1298]],[1274,[1291,[1292,[1293],[1294],[1295],[1296],[1297]]]],[1275,[1287],[1288],[1289],[1290]],[1276],[1277,[1286]],[1278,[1282,[1283,[1284],[1285]]]],[1279,[1280],[1281]]],[1160,[1223],[1224,[1264]],[1225,[1260,[1261,[1262],[1263]]]],[1226,[1258],[1259]],[1227,[1253,[1254,[1255],[1256],[1257]]]],[1228,[1251],[1252]],[1229,[1246,[1247,[1248],[1249],[1250]]]],[1230],[1231,[1242,[1243,[1244],[1245]]]],[1232],[1233,[1238,[1239,[1240],[1241]]]],[1234,[1235],[1236],[1237]]],[1161,[1165],[1166],[1167,[1221],[1222]],[1168,[1217,[1218,[1219],[1220]]]],[1169],[1170],[1171,[1212,[1213,[1214],[1215],[1216]]]],[1172],[1173,[1207,[1208,[1209],[1210],[1211]]]],[1174,[1206]],[1175,[1205]],[1176,[1197,[1198,[1199],[1200],[1201],[1202],[1203],[1204]]]],[1177],[1178,[1192,[1193,[1194],[1195],[1196]]]],[1179,[1191]],[1180],[1181,[1187,[1188,[1189],[1190]]]],[1182,[1183],[1184],[1185],[1186]]],[1162,[1163],[1164]]],[548,[800],[801],[802],[803,[993],[994,[1154]],[995,[1118],[1119,[1153]],[1120,[1150],[1151],[1152]],[1121,[1147,[1149]],[1148]],[1122,[1146]],[1123,[1140,[1141,[1142],[1143],[1144],[1145]]]],[1124,[1139]],[1125],[1126,[1135,[1136,[1137],[1138]]]],[1127],[1128,[1131,[1132,[1133],[1134]]]],[1129,[1130]]],[996,[1051],[1052,[1117]],[1053,[1113,[1114,[1115],[1116]]]],[1054,[1111],[1112]],[1055,[1086,[1087,[1088],[1089],[1090],[1091],[1092],[1093],[1094],[1095],[1096],[1097],[1098],[1099],[1100],[1101],[1102],[1103],[1104],[1105],[1106],[1107],[1108],[1109],[1110]]]],[1056,[1084],[1085]],[1057,[1078,[1079,[1080],[1081],[1082],[1083]]]],[1058,[1076],[1077]],[1059,[1069,[1070,[1071],[1072],[1073],[1074],[1075]]]],[1060],[1061,[1068]],[1062,[1066,[1067]]],[1063,[1065]],[1064]],[997,[1002],[1003],[1004,[1045,[1046,[1047],[1048],[1049],[1050]]]],[1005],[1006,[1043],[1044]],[1007,[1038,[1039,[1040],[1041],[1042]]]],[1008],[1009,[1033,[1034,[1035],[1036],[1037]]]],[1010,[1032]],[1011,[1027,[1028,[1029],[1030],[1031]]]],[1012,[1025],[1026]],[1013,[1022,[1024]],[1023]],[1014,[1020],[1021]],[1015,[1017],[1018],[1019]],[1016]],[998,[999],[1000],[1001]]],[804,[809],[810],[811,[988,[989,[990],[991],[992]]]],[812,[978],[979],[980,[987]],[981,[982,[983,[984],[985],[986]]]]],[813,[955],[956],[957,[974,[975,[976],[977]]]],[958],[959],[960,[969,[970,[971],[972],[973]]]],[961],[962,[965,[966,[967],[968]]]],[963,[964]]],[814,[852],[853],[854,[951,[952,[953],[954]]]],[855],[856,[946,[947,[948],[949],[950]]]],[857,[943],[944],[945]],[858,[939,[940,[941],[942]]]],[859,[936],[937],[938]],[860,[933],[934],[935]],[861,[902,[903,[904],[905],[906],[907],[908],[909],[910],[911],[912],[913],[914],[915],[916],[917],[918],[919],[920],[921],[922],[923],[924],[925],[926],[927],[928],[929],[930],[931],[932]]]],[862,[901]],[863],[864,[896,[897,[898],[899],[900]]]],[865,[895]],[866,[894]],[867,[890,[891,[892],[893]]]],[868],[869,[886,[887,[888],[889]]]],[870],[871,[882,[883,[884],[885]]]],[872,[880],[881]],[873,[875,[876,[877],[878],[879]]]],[874]],[815,[816],[817],[818,[850,[851]]],[819,[849]],[820,[847,[848]]],[821],[822,[842,[843,[844],[845],[846]]]],[823],[824,[841]],[825,[834,[835,[836],[837],[838],[839],[840]]]],[826,[832],[833]],[827,[829],[830],[831]],[828]]],[805,[806],[807],[808]]],[549,[550],[551,[798],[799]],[552],[553,[786],[787],[788,[797]],[789,[796]],[790],[791,[792,[793,[794],[795]]]]],[554,[752,[785]],[753,[784]],[754,[780,[781,[782],[783]]]],[755,[779]],[756],[757,[774,[775,[776],[777],[778]]]],[758,[773]],[759,[772]],[760,[765,[766,[767],[768],[769],[770],[771]]]],[761,[762],[763],[764]]],[555,[715,[751]],[716],[717,[743,[744,[745],[746],[747],[748],[749],[750]]]],[718,[742]],[719],[720,[732,[733,[734],[735],[736],[737],[738],[739],[740],[741]]]],[721,[724],[725],[726],[727],[728],[729],[730],[731]],[722,[723]]],[556,[693],[694,[707,[708],[709,[710,[711,[712],[713],[714]]]]]],[695],[696,[698,[699,[705,[706]]],[700,[704]],[701,[702,[703]]]]],[697]],[557,[636,[692]],[637,[691]],[638,[687,[688,[689],[690]]]],[639,[686]],[640,[681,[682,[683],[684],[685]]]],[641],[642,[673,[674,[678,[679],[680]]],[675,[676,[677]]]]],[643],[644,[668,[669,[670],[671],[672]]]],[645,[666],[667]],[646,[660,[661,[662],[663],[664],[665]]]],[647,[657],[658],[659]],[648],[649,[650,[651,[656]],[652,[655]],[653,[654]]]]],[558,[562,[635]],[563,[634]],[564,[630,[631,[632],[633]]]],[565],[566,[626,[627,[628],[629]]]],[567,[624],[625]],[568],[569,[619,[620,[623]],[621,[622]]]],[570],[571,[612,[613,[614],[615],[616],[617],[618]]]],[572,[609],[610],[611]],[573,[600,[601,[602],[603],[604],[605],[606],[607],[608]]]],[574,[599]],[575],[576,[596,[597,[598]]]],[577],[578,[593,[595]],[594]],[579],[580],[581,[588,[589,[590],[591],[592]]]],[582,[583],[584],[585],[586],[587]]],[559,[560],[561]]]],[8,[12],[13],[14,[464],[465,[542],[543]],[466,[538],[539],[540],[541]],[467,[536,[537]]],[468],[469,[530,[531,[532],[533],[534],[535]]]],[470,[527],[528],[529]],[471,[521],[522],[523],[524],[525],[526]],[472,[516,[517,[518],[519],[520]]]],[473,[515]],[474,[513,[514]]],[475],[476,[511,[512]]],[477,[510]],[478,[509]],[479],[480,[504,[505,[506],[507],[508]]]],[481,[503]],[482,[502]],[483,[497,[498,[499],[500],[501]]]],[484],[485,[493,[494,[495],[496]]]],[486],[487,[489,[490,[491],[492]]]],[488]],[15,[407],[408],[409,[460,[461,[462],[463]]]],[410],[411,[456,[457,[458],[459]]]],[412,[455]],[413,[449,[450,[451],[452],[453],[454]]]],[414,[448]],[415,[446,[447]]],[416,[445]],[417,[443,[444]]],[418],[419,[437,[438,[439],[440],[441],[442]]]],[420,[434],[435],[436]],[421,[429,[430,[431],[432],[433]]]],[422],[423,[424,[425,[426],[427],[428]]]]],[16,[354],[355],[356,[404],[405,[406]]],[357,[358],[359],[360,[400,[401,[402],[403]]]],[361,[398,[399]]],[362,[397]],[363,[393,[394,[395],[396]]]],[364,[390],[391],[392]],[365,[388],[389]],[366,[384,[385,[386],[387]]]],[367,[383]],[368,[378,[379,[380],[381],[382]]]],[369,[376],[377]],[370,[372,[373,[374],[375]]]],[371]]],[17,[308],[309],[310,[352,[353]]],[311,[351]],[312,[348,[349,[350]]]],[313,[345],[346],[347]],[314,[342,[343,[344]]]],[315,[338],[339],[340],[341]],[316,[335,[336,[337]]]],[317],[318],[319,[331,[332,[333],[334]]]],[320,[330]],[321,[325,[326,[327],[328],[329]]]],[322,[324]],[323]],[18,[19],[20,[305],[306],[307]],[21,[303],[304]],[22,[299,[300,[301],[302]]]],[23,[298]],[24,[296],[297]],[25],[26,[281,[282,[283],[284],[285],[286],[287],[288],[289],[290],[291],[292],[293],[294],[295]]]],[27,[278],[279],[280]],[28,[275,[276,[277]]]],[29],[30,[268,[269,[270],[271],[272],[273],[274]]]],[31,[267]],[32,[264,[265,[266]]]],[33,[263]],[34,[249,[250,[251],[252],[253],[254],[255],[256],[257],[258],[259],[260],[261],[262]]]],[35],[36,[245,[246,[247],[248]]]],[37],[38,[229,[230,[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],[242],[243],[244]]]],[39],[40,[227,[228]]],[41,[226]],[42,[216,[217,[218],[219],[220],[221],[222],[223],[224],[225]]]],[43,[215]],[44,[206,[207,[208],[209],[210],[211],[212],[213],[214]]]],[45,[205]],[46],[47,[203,[204]]],[48,[202]],[49,[185,[186,[187],[188],[189],[190],[191],[192],[193],[194],[195],[196],[197],[198],[199],[200],[201]]]],[50,[184]],[51],[52,[180,[181,[182],[183]]]],[53,[174,[175],[176,[177,[178,[179]]]]]],[54],[55,[92,[93,[94],[95],[96],[97],[98],[99],[100],[101],[102],[103],[104],[105],[106],[107],[108],[109],[110],[111],[112],[113],[114],[115],[116],[117],[118],[119],[120],[121],[122],[123],[124],[125],[126],[127],[128],[129],[130],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[156],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],[167],[168],[169],[170],[171],[172],[173]]]],[56],[57,[86,[87,[88],[89],[90],[91]]]],[58,[84],[85]],[59,[79,[80,[81],[82],[83]]]],[60,[78]],[61,[74,[75,[76],[77]]]],[62,[73]],[63,[67,[68,[69],[70],[71],[72]]]],[64,[65],[66]]]],[9,[10],[11]]]]],"tag_map":[{"a":[["lang","en"]],"n":"html"},{"x":"\n    ","n":"head","l":"\n  "},{"a":[["class","calibre1 pcalibre1 pcalibre"]],"x":"\n","n":"body","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["id","ch09-git-and-other-scms"],["title","Git 与其他系统"],["type","chapter"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["id","DB7S2-78ecc950e459438e8d0462081a6fa7a8"]],"x":"\n","n":"header","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现实并不总是尽如人意。\n通常，你不能立刻就把接触到的每一个项目都切换到 Git。\n有时候你被困在使用其他 VCS 的项目中，却希望使用 Git。\n在本章的第一部分我们将会了解到，怎样在你的那些托管在不同系统的项目上使用 Git 客户端。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在某些时候，你可能想要将已有项目转换到 Git。\n本章的第二部分涵盖了从几个特定系统将你的项目迁移至 Git 的方法，即使没有预先构建好的导入工具，我们也有办法手动导入。","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","作为客户端的 Git"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","迁移到 Git"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","总结"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre6 pcalibre1 pcalibre"],["id","_总结"]],"x":"总结","n":"h2","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你会觉得将 Git 作为其他版本控制系统的客户端，或者在数据无损的情况下将几乎任何一个现有的仓库导入到 Git，都是一件很惬意的事。\n在下一章，我们将要讲解 Git 的原始内部数据，如果需要的话你就可以加工每一个字节。","n":"p","l":"\n"},{"a":[["class","calibre6 pcalibre1 pcalibre"],["id","r_migrating"]],"x":"迁移到 Git","n":"h2","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n如果你现在有一个正在使用其他 VCS 的代码库，但是你已经决定开始使用 Git，必须通过某种方式将你的项目迁移至 Git。\n这一部分会介绍一些通用系统的导入器，然后演示如何开发你自己定制的导入器。\n你将会学习如何从几个大型专业应用的 SCM 系统中导入数据，不仅因为它们是大多数想要转换的用户正在使用的系统，也因为获取针对它们的高质量工具很容易。","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Subversion"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Mercurial"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Perforce"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","TFS"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","一个自定义的导入器"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","r_custom_importer"]],"x":"一个自定义的导入器","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n\n如果你的系统不是上述中的任何一个，你需要在线查找一个导入器 - 针对许多其他系统有很多高质量的导入器，包括 CVS、Clear Case、Visual Source Safe，甚至是一个档案目录。\n如果没有一个工具适合你，需要一个不知名的工具，或者需要更大自由度的自定义导入过程，应当使用 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了快速演示，我们会写一个简单的导入器。\n假设你在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了导入一个 Git 目录，需要了解 Git 如何存储它的数据。\n你可能记得，Git 在底层存储指向内容快照的提交对象的链表。\n所有要做的就是告诉 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如同我们在 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在开始，需要进入目标目录中并识别每一个子目录，每一个都是你要导入为提交的快照。\n要进入到每个子目录中并为导出它打印必要的命令。\n基本主循环像这个样子：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在每个目录内运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"可以创建一个目录的数组并使用索引做为标记，因为标记必须是一个整数。\n方法类似这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"既然有一个整数代表你的提交，那还要给提交元数据一个日期。\n因为目录名字表达了日期，所以你将会从中解析出日期。\n你的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"那会返回每一个目录日期的整数。\n最后一项每个提交需要的元数据是提交者信息，它将会被硬编码在全局变量中：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在准备开始为你的导入器打印出提交数据。\n初始信息声明定义了一个提交对象与它所在的分支，紧接着一个你生成的标记、提交者信息与提交信息、然后是一个之前的提交，如果它存在的话。\n代码看起来像这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"我们将硬编码时区信息（-0700），因为这样很容易。\n如果从其他系统导入，必须指定为一个偏移的时区。\n提交信息必须指定为特殊的格式：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这个格式包括文本数据、将要读取数据的大小、一个换行符、最终的数据。\n因为之后还需要为文件内容指定相同的数据格式，你需要创建一个帮助函数，","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"剩下的工作就是指定每一个快照的文件内容。\n这很轻松，因为每一个目录都是一个快照 - 可以在目录中的每一个文件内容后打印 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意：因为大多数系统认为他们的版本是从一个提交变化到另一个提交，fast-import 也可以为每一个提交执行命令来指定哪些文件是添加的、删除的或修改的与新内容是哪些。\n可以计算快照间的不同并只提供这些数据，但是这样做会很复杂 - 也可以把所有数据给 Git 然后让它为你指出来。\n如果这更适合你的数据，查阅 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这种列出新文件内容或用新内容指定修改文件的格式如同下面的内容：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这里，644 是模式（如果你有可执行文件，反而你需要检测并指定 755），inline 表示将会立即把内容放在本行之后。\n你的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"可以重用之前定义的 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"最后一件你需要做的是返回当前的标记以便它可以传给下一个迭代：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","admonition pcalibre1 pcalibre8"],["title","Note"],["type","note"]],"x":"\n","n":"aside","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"就是这样。\n这是全部的脚本：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果运行这个脚本，你会得到类似下面的内容：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了运行导入器，将这些输出用管道重定向到你想要导入的 Git 目录中的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"正如你所看到的，当它成功完成时，它会给你一串关于它完成内容的统计。\n这本例中，一共导入了 13 个对象、4 次提交到 1 个分支。\n现在，可以运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"做得很好 - 一个漂亮、干净的 Git 仓库。\n要注意的一点是并没有检出任何东西 - 一开始你的工作目录内并没有任何文件。\n为了得到他们，你必须将分支重置到 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"可以通过 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"fast-import","n":"code","l":" 工具做很多事情 - 处理不同模式、二进制数据、多个分支与合并、标签、进度指示等等。\n一些更复杂情形下的例子可以在 Git 源代码目录中的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"contrib/fast-import","n":"code","l":" 目录中找到。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" ls\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git reset --hard master\nHEAD is now at 3caa046 imported from current\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" ls\nREADME.md main.rb"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 所在的地方："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log -2\ncommit 3caa046d4aac682a55867132ccdfbe0d3fdee498\nAuthor: John Doe <john@example.com>\nDate:   Tue Jul 29 19:39:04 2014 -0700\n\n    imported from current\n\ncommit 4afc2b945d0d3c8cd00556fbe2e8224569dc9def\nAuthor: John Doe <john@example.com>\nDate:   Mon Feb 3 01:00:00 2014 -0700\n\n    imported from back_2014_02_03"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git log","n":"code","l":" 来看一下你的新历史："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git init\nInitialized empty Git repository in /opt/import_to/.git/\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" ruby import.rb /opt/import_from | git fast-import\ngit-fast-import statistics:\n---------------------------------------------------------------------\nAlloc'd objects:       5000\nTotal objects:           13 (         6 duplicates                  )\n      blobs  :            5 (         4 duplicates          3 deltas of          5 attempts)\n      trees  :            4 (         1 duplicates          0 deltas of          4 attempts)\n      commits:            4 (         1 duplicates          0 deltas of          0 attempts)\n      tags   :            0 (         0 duplicates          0 deltas of          0 attempts)\nTotal branches:           1 (         1 loads     )\n      marks:           1024 (         5 unique    )\n      atoms:              2\nMemory total:          2344 KiB\n       pools:          2110 KiB\n     objects:           234 KiB\n---------------------------------------------------------------------\npack_report: getpagesize()            =       4096\npack_report: core.packedGitWindowSize = 1073741824\npack_report: core.packedGitLimit      = 8589934592\npack_report: pack_used_ctr            =         10\npack_report: pack_mmap_calls          =          5\npack_report: pack_open_windows        =          2 /          2\npack_report: pack_mapped              =       1457 /       1457\n---------------------------------------------------------------------"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git fast-import","n":"code","l":"。\n可以创建一个新的目录并在其中运行 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git init","n":"code","l":" 作为开始，然后运行你的脚本："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" ruby import.rb /opt/import_from\ncommit refs/heads/master\nmark :1\ncommitter John Doe <john@example.com> 1388649600 -0700\ndata 29\nimported from back_2014_01_02deleteall\nM 644 inline README.md\ndata 28\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":" Hello\n\nThis is my readme.\ncommit refs/heads/master\nmark :2\ncommitter John Doe <john@example.com> 1388822400 -0700\ndata 29\nimported from back_2014_01_04from :1\ndeleteall\nM 644 inline main.rb\ndata 34\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"!/bin/env ruby\n\nputs \"Hey there\"\nM 644 inline README.md\n(...)"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"#!/usr/bin/env ruby","n":"span","l":"\n\n$stdout.binmode\n$author = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"John Doe <john@example.com>\"","n":"span","l":"\n\n$marks = []\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" convert_dir_to_mark(dir)\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" !$marks.include?(dir)\n        $marks << dir\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n    ($marks.index(dir)+1).to_s\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" convert_dir_to_date(dir)\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" dir == "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'current'","n":"span","l":"\n        "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"return","n":"span","l":" Time.now().to_i\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"else","n":"span","l":"\n        dir = dir.gsub("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'back_'","n":"span","l":", "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"''","n":"span","l":")\n        (year, month, day) = dir.split("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'_'","n":"span","l":")\n        "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"return","n":"span","l":" Time.local(year, month, day).to_i\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" export_data(string)\n    print "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"data ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"string.size"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}\\n#{","n":"span","l":"string"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" inline_data(file, code="},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'M'","n":"span","l":", mode="},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'644'","n":"span","l":")\n    content = File.read(file)\n    puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"code"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"mode"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" inline ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"file"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":"\n    export_data(content)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" print_export(dir, last_mark)\n    date = convert_dir_to_date(dir)\n    mark = convert_dir_to_mark(dir)\n\n    puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'commit refs/heads/master'","n":"span","l":"\n    puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"mark :","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"mark"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":"\n    puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"committer ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"$author"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"date"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" -0700\"","n":"span","l":"\n    export_data("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"imported from ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"dir"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":")\n    puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"from :","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"last_mark"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":" "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" last_mark\n\n    puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'deleteall'","n":"span","l":"\n    Dir.glob("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"**/*\"","n":"span","l":").each "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":" |file|\n        "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"next","n":"span","l":" "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" !File.file?(file)\n        inline_data(file)\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n    mark\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n\n\n"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"# Loop through the directories","n":"span","l":"\nlast_mark = "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"nil","n":"span","l":"\nDir.chdir(ARGV[0]) "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":"\n    Dir.glob("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"*\"","n":"span","l":").each "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":" |dir|\n        "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"next","n":"span","l":" "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" File.file?(dir)\n\n        "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"# move into the target directory","n":"span","l":"\n        Dir.chdir(dir) "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":"\n            last_mark = print_export(dir, last_mark)\n        "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","content1 pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果在 Windows 上还需要确保增加一个额外步骤。\n正如之前提到的，Windows 使用 CRLF 作为换行符而 git fast-import 只接受 LF。\n为了修正这个问题使 git fast-import 正常工作，你需要告诉 ruby 使用 LF 代替 CRLF：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","source1 pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"$stdout.binmode"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"return","n":"span","l":" mark"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"export_data","n":"code","l":" 方法，因为它与你定义的提交信息数据的方法一样。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" inline_data(file, code = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'M'","n":"span","l":", mode = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'644'","n":"span","l":")\n  content = File.read(file)\n  puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"code"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"mode"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" inline ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"file"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":"\n  export_data(content)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"inline_data","n":"code","l":" 方法看起来像这样："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"M 644 inline path/to/file\ndata (size)\n(file contents)","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"fast-import","n":"code","l":" man 帮助页来了解如何以这种方式提供你的数据。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"puts "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'deleteall'","n":"span","l":"\nDir.glob("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"**/*\"","n":"span","l":").each "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":" |file|\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"next","n":"span","l":" "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" !File.file?(file)\n  inline_data(file)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"deleteall","n":"code","l":" 命令。\nGit 将会适当地记录每一个快照："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" export_data(string)\n  print "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"data ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"string.size"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}\\n#{","n":"span","l":"string"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"export_data","n":"code","l":"："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"data (size)\\n(contents)","n":"code"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"# print the import information","n":"span","l":"\nputs "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'commit refs/heads/master'","n":"span","l":"\nputs "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'mark :'","n":"span","l":" + mark\nputs "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"committer ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"$author"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" ","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"#{","n":"span","l":"date"},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"}","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":" -0700\"","n":"span","l":"\nexport_data("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'imported from '","n":"span","l":" + dir)\nputs "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'from :'","n":"span","l":" + last_mark "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" last_mark"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"$author = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'John Doe <john@example.com>'","n":"span"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" convert_dir_to_date(dir)\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" dir == "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'current'","n":"span","l":"\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"return","n":"span","l":" Time.now().to_i\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"else","n":"span","l":"\n    dir = dir.gsub("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'back_'","n":"span","l":", "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"''","n":"span","l":")\n    (year, month, day) = dir.split("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'_'","n":"span","l":")\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"return","n":"span","l":" Time.local(year, month, day).to_i\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"convert_dir_to_date","n":"code","l":" 定义为"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"date = convert_dir_to_date(dir)"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"print_export","n":"code","l":" 文件的下一行是"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"$marks = []\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"def","n":"span","l":" convert_dir_to_mark(dir)\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" !$marks.include?(dir)\n    $marks << dir\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n  ($marks.index(dir) + 1).to_s\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"mark = convert_dir_to_mark(dir)"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"print_export","n":"code","l":"，将会拿到清单并标记之前的快照，然后返回清单并标记现在的快照；通过这种方式，可以将它们合适地连接在一起。\n“标记” 是一个给提交标识符的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"fast-import","n":"code","l":" 术语；当你创建提交，为每一个提交赋予一个标记来将它与其他提交连接在一起。\n这样，在你的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"print_export","n":"code","l":" 方法中第一件要做的事就是从目录名字生成一个标记："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"last_mark = "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"nil","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"# loop through the directories","n":"span","l":"\nDir.chdir(ARGV[0]) "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":"\n  Dir.glob("},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"\"*\"","n":"span","l":").each "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":" |dir|\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"next","n":"span","l":" "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"if","n":"span","l":" File.file?(dir)\n\n    "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"# move into the target directory","n":"span","l":"\n    Dir.chdir(dir) "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"do","n":"span","l":"\n      last_mark = print_export(dir, last_mark)\n    "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n  "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"end","n":"span"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","javascript:void(0)"],["id","xref--ch08-customizing-git--r_an_example_git_enforced_policy"],["data-ezPJKgrMLI5iYpd7vlZT7E","{\"frag\": \"r_an_example_git_enforced_policy\", \"name\": \"text/part0013.html\"}"]],"x":"使用强制策略的一个例子","n":"a","l":" 里做的，我们将会使用 Ruby 写这个，因为它是我们平常工作中使用的并且它很容易读懂。\n可以使用任何你熟悉的东西来非常轻松地写这个例子 - 它只需要将合适的信息打印到 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"标准输出","n":"code","l":"。\n然而，如果你在 Windows 上，这意味着需要特别注意不要引入回车符到行尾 - git fast-import 非常特别地只接受换行符（LF）而不是 Windows 使用的回车换行符（CRLF）。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"fast-import","n":"code","l":" 哪些内容是快照，哪个提交数据指向它们，以及它们进入的顺序。\n你的策略是一次访问一个快照，然后用每个目录中的内容创建提交，并且将每一个提交与前一个连接起来。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" ls /opt/import_from\nback_2014_01_02\nback_2014_01_04\nback_2014_01_14\nback_2014_02_03\ncurrent"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"current","n":"code","l":" 工作，有时候会备份你的项目到时间标签 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"back_YYYY_MM_DD","n":"code","l":" 备份目录中，你想要将这些导入到 Git 中。\n目录结构看起来是这样："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git fast-import","n":"code","l":"。\n这个命令从标准输入中读取简单指令来写入特定的 Git 数据。\n通过这种方式创建 Git 对象比运行原始 Git 命令或直接写入原始对象（查看 "},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","javascript:void(0)"],["id","xref--ch10-git-internals"],["data-ezPJKgrMLI5iYpd7vlZT7E","{\"frag\": \"E9OE2-78ecc950e459438e8d0462081a6fa7a8\", \"name\": \"text/part0015.html\"}"]],"x":"Git 内部原理","n":"a","l":" 了解更多内容）更容易些。\n通过这种方式你可以编写导入脚本，从你要导入的系统中读取必要数据，然后直接打印指令到标准输出。\n然后可以运行这个程序并通过 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git fast-import","n":"code","l":" 重定向管道输出。"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","r_git_tfs"]],"x":"TFS","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n如果你的团队正在将他们的源代码管理从 TFVC 转换为 Git，你们会想要最高程度的无损转换。\n这意味着，虽然我们在之前的交互章节介绍了 git-tfs 与 git-tf 两种工具，但是我们在本部分只能介绍 git-tfs，因为 git-tfs 支持分支，而使用 git-tf 代价太大。","n":"p","l":"\n"},{"a":[["class","admonition pcalibre1 pcalibre8"],["title","Note"],["type","note"]],"x":"\n","n":"aside","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"第一件事是映射用户名。\nTFVC 对待变更集作者字段的内容相当宽容，但是 Git 需要人类可读的名字与邮箱地址。\n可以通过 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这会将历史中的所有变更集抓取下来并放到 AUTHORS_TMP 文件中，然后我们将会将 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"左边的部分是 TFVC 中的 “User” 字段，等号右边的部分是将被用作 Git 提交的用户名。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"一旦有了这个文件，下一件事就是生成一个你需要的 TFVC 项目的完整克隆：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"接下来要从提交信息底部清理 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"那会使用 Git 终端环境中的 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"全部完成后，你就已经准备好去增加一个新的远程仓库，推送你所有的分支上去，然后你的团队就可以开始用 Git 工作了。","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"sed","n":"code","l":" 命令来将所有以 “git-tfs-id:” 开头的行替换为 Git 会忽略的空白。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"filter","n":"span","l":"-branch -f --msg-filter "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'sed \"s/^git-tfs-id:.*$//g\"'","n":"span","l":" -- --all"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-tfs-id","n":"code","l":" 区块。\n下面的命令会完成这个任务："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git tfs clone --with-branches --authors=AUTHORS https"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"//username.visualstudio.com/DefaultCollection $/project/Trunk project_git"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"DOMAIN\\username = User Name <email@address.com>"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"cut","n":"code","l":" 命令只会保留每行中第 11 个到第 22 个字符。\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tail","n":"code","l":" 命令会跳过前两行，就是字段表头与 ASCII 风格的下划线。\n所有这些的结果通过管道送到 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"uniq","n":"code","l":" 来去除重复，然后保存到 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"AUTOHRS","n":"code","l":" 文件中。\n下一步是手动的；为了让 git-tfs 有效地使用这个文件，每一行必须是这种格式："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> cat AUTHORS_TMP | cut -b 11-20 | tail -n+3 | uniq | sort > AUTHORS"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"User","n":"code","l":" 列（第二个）取出来。\n打开文件找到列开始与结束的字符并替换，在下面的命令行中，"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"cut","n":"code","l":" 命令的参数 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"11-20","n":"code","l":" 就是我们找到的："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> tf history $/myproject -recursive > AUTHORS_TMP"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tf","n":"code","l":" 命令行客户端来获取这个信息，像这样："},{"a":[["class","content1 pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这是一个单向转换。\n这意味着 Git 仓库无法连接到原始的 TFVC 项目。","n":"p","l":"\n"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","r_perforce_import"]],"x":"Perforce","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n下一个将要看到导入的系统是 Perforce。\n就像我们之前讨论过的，有两种方式让 Git 与 Perforce 互相通信：git-p4 与 Perforce Git Fusion。","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Perforce Git Fusion"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git-p4"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","r_git_p4"]],"x":"Git-p4","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-p4 也可以作为一个导入工具。\n作为例子，我们将从 Perforce 公开仓库中导入 Jam 项目。\n为了设置客户端，必须导出 P4PORT 环境变量指向 Perforce 仓库：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","admonition pcalibre1 pcalibre8"],["title","Note"],["type","note"]],"x":"\n","n":"aside","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这个特定的项目只有一个分支，但是如果你在分支视图（或者说一些目录）中配置了一些分支，你可以将 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"此时你几乎已经完成了。\n如果进入 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你可以看到 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在导入已经准备好推送到你的新 Git 服务器上了。","n":"p","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log -2\ncommit b17341801ed838d97f7800a54a6f9b95750839b7\nAuthor: giles <giles@giles@perforce.com>\nDate:   Wed Feb 8 03:13:27 2012 -0800\n\n    Correction to line 355; change </UL> to </OL>.\n\ncommit 3e68c2e26cd89cb983eb52c024ecdfba1d6b3fff\nAuthor: kwirth <kwirth@perforce.com>\nDate:   Tue Jul 7 01:35:51 2009 -0800\n\n    Fix spelling error on Jam doc page (cummulative -> cumulative)."},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git log","n":"code","l":"，你会看到所有提交的 SHA-1 校验和都改变了，但是提交信息中不再有 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-p4","n":"code","l":" 字符串了："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git filter-branch --msg-filter "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'sed -e \"/^\\[git-p4:/d\"'","n":"span","l":"\nRewrite e5da1c909e5db3036475419f6379f2c73710c4e6 (125/125)\nRef 'refs/heads/master' was rewritten"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-p4`在每一个提交里都留下了一个标识符。\n如果之后想要引用 Perforce 的修改序号的话，标识符保留在那里也是可以的。\n然而，如果想要移除标识符，现在正是这么做的时候 - 在你开始在新仓库中工作之前。\n(((git commands, filter-branch)))\n可以使用 `git filter-branch","n":"code","l":" 将全部标识符移除。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log -2\ncommit e5da1c909e5db3036475419f6379f2c73710c4e6\nAuthor: giles <giles@giles@perforce.com>\nDate:   Wed Feb 8 03:13:27 2012 -0800\n\n    Correction to line 355; change </UL> to </OL>.\n\n    [git-p4: depot-paths = \"//public/jam/src/\": change = 8068]\n\ncommit aa21359a0a135dda85c50a7f7cf249e4f7b8fd98\nAuthor: kwirth <kwirth@perforce.com>\nDate:   Tue Jul 7 01:35:51 2009 -0800\n\n    Fix spelling error on Jam doc page (cummulative -> cumulative).\n\n    [git-p4: depot-paths = \"//public/jam/src/\": change = 7304]"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4import","n":"code","l":" 目录中并运行 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git log","n":"code","l":"，可以看到你的导入工作："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--detect-branches","n":"code","l":" 选项传递给 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 clone","n":"code","l":" 来导入项目的所有分支。\n查看 "},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","javascript:void(0)"],["id","xref-r_git_p4_branches"],["data-ezPJKgrMLI5iYpd7vlZT7E","{\"frag\": \"r_git_p4_branches\", \"name\": \"text/part0014.html\"}"]],"x":"分支","n":"a","l":" 来了解关于这点的更多信息。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git-p4 clone //guest/perforce_software/jam@all p4import\nImporting from //guest/perforce_software/jam@all into p4import\nInitialized empty Git repository in /private/tmp/p4import/.git/\nImport destination: refs/remotes/p4/master\nImporting revision 9957 (100%)"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 clone","n":"code","l":" 命令从 Perforce 服务器导入 Jam 项目，提供仓库、项目路径与你想要存放导入项目的路径："},{"a":[["class","content1 pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了继续后续步骤，需要连接到 Perforce 仓库。\n在我们的例子中将会使用在 public.perforce.com 的公开仓库，但是你可以使用任何你有权限的仓库。","n":"p","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" export P4PORT=public.perforce.com:1666"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_perforce_git_fusion"]],"x":"Perforce Git Fusion","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git Fusion 使这个过程毫无痛苦。\n只需要使用在 ","n":"p","l":"\n"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","javascript:void(0)"],["id","xref-r_p4_git_fusion"],["data-ezPJKgrMLI5iYpd7vlZT7E","{\"frag\": \"r_p4_git_fusion\", \"name\": \"text/part0014.html\"}"]],"x":"Git Fusion","n":"a","l":" 中讨论过的配置文件来配置你的项目设置、用户映射与分支，然后克隆整个仓库。\nGit Fusion 让你处在一个看起来像是原生 Git 仓库的环境中，如果愿意的话你可以随时将它推送到一个原生 Git 托管中。\n如果你喜欢的话甚至可以使用 Perforce 作为你的 Git 托管。"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","_mercurial"]],"x":"Mercurial","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n因为 Mercurial 与 Git 在表示版本时有着非常相似的模型，也因为 Git 拥有更加强大的灵活性，将一个仓库从 Mercurial 转换到 Git 是相当直接的，使用一个叫作“hg-fast-export”的工具，需要从这里拷贝一份：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"转换的第一步就是要先得到想要转换的 Mercurial 仓库的完整克隆：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"下一步就是创建一个作者映射文件。\nMercurial 对放入到变更集作者字段的内容比 Git 更宽容一些，所以这是一个清理的好机会。\n只需要用到 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这会花费几秒钟，具体要看项目提交历史有多少，最终 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在这个例子中，同一个人（Bob）使用不同的名字创建变更集，其中一个实际上是正确的，另一个完全不符合 Git 提交的规范。\nHg-fast-export 通过向我们想要修改的行尾添加 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"下一步是创建一个新的 Git 仓库，然后运行导出脚本：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"那看起来非常好。\n所有 Mercurial 标签都已被转换成 Git 标签，Mercurial 分支与书签都被转换成 Git 分支。\n现在已经准备好将仓库推送到新的服务器那边：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git remote add origin git@my-git-server:myrepository.git\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git push origin --all"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" /tmp/fast-export/hg-fast-export.sh -r /tmp/hg-repo -A /tmp/authors\nLoaded 4 authors\nmaster: Exporting full revision 1/22208 with 13/0/0 added/changed/removed files\nmaster: Exporting simple delta revision 2/22208 with 1/1/0 added/changed/removed files\nmaster: Exporting simple delta revision 3/22208 with 0/1/0 added/changed/removed files\n[…]\nmaster: Exporting simple delta revision 22206/22208 with 0/4/0 added/changed/removed files\nmaster: Exporting simple delta revision 22207/22208 with 0/2/0 added/changed/removed files\nmaster: Exporting thorough delta revision 22208/22208 with 3/213/0 added/changed/removed files\nExporting tag [0.4c] at [hg r9] [git :10]\nExporting tag [0.4d] at [hg r16] [git :17]\n[…]\nExporting tag [3.1-rc] at [hg r21926] [git :21927]\nExporting tag [3.1] at [hg r21973] [git :21974]\nIssued 22315 commands\ngit-fast-import statistics:\n---------------------------------------------------------------------\nAlloc'd objects:     120000\nTotal objects:       115032 (    208171 duplicates                  )\n      blobs  :        40504 (    205320 duplicates      26117 deltas of      39602 attempts)\n      trees  :        52320 (      2851 duplicates      47467 deltas of      47599 attempts)\n      commits:        22208 (         0 duplicates          0 deltas of          0 attempts)\n      tags   :            0 (         0 duplicates          0 deltas of          0 attempts)\nTotal branches:         109 (         2 loads     )\n      marks:        1048576 (     22208 unique    )\n      atoms:           1952\nMemory total:          7860 KiB\n       pools:          2235 KiB\n     objects:          5625 KiB\n---------------------------------------------------------------------\npack_report: getpagesize()            =       4096\npack_report: core.packedGitWindowSize = 1073741824\npack_report: core.packedGitLimit      = 8589934592\npack_report: pack_used_ctr            =      90430\npack_report: pack_mmap_calls          =      46771\npack_report: pack_open_windows        =          1 /          1\npack_report: pack_mapped              =  340852700 /  340852700\n---------------------------------------------------------------------\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git shortlog -sn\n   369  Bob Jones\n   365  Joe Smith"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"-r","n":"code","l":" 选项告诉 hg-fast-export 去哪里寻找我们想要转换的 Mercurial 仓库，"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"-A","n":"code","l":" 标记告诉它在哪找到作者映射文件。\n这个脚本会分析 Mercurial 变更集然后将它们转换成 Git“fast-import”功能（我们将在之后详细讨论）需要的脚本。\n这会花一点时间（尽管它比通过网格 "},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"更","n":"em","l":" 快），输出相当的冗长："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git init /tmp/converted\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd /tmp/converted\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" /tmp/fast-export/hg-fast-export.sh -r /tmp/hg-repo -A /tmp/authors"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"bob=Bob Jones <bob@company.com>\nbob@localhost=Bob Jones <bob@company.com>\nbob jones <bob <AT> company <DOT> com>=Bob Jones <bob@company.com>\nbob <bob@company.com>=Bob Jones <bob@company.com>","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"={new name and email address}","n":"code","l":" 来修正这个问题，移除任何我们想要保留的用户名所在的行。\n如果所有的用户名看起来都是正确的，那我们根本就不需要这个文件。\n在本例中，我们会使文件看起来像这样："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"bob\nbob@localhost\nbob <bob@company.com>\nbob jones <bob <AT> company <DOT> com>\nBob Jones <bob@company.com>\nJoe Smith <joe@company.com>","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"/tmp/authors","n":"code","l":" 文件看起来会像这样："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd /tmp/hg-repo\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg log | grep user: | sort | uniq | sed "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'s/user: *//'","n":"span","l":" > ../authors"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"bash","n":"code","l":" 终端下的一行命令："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg clone <remote repo URL> /tmp/hg-repo"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git clone http://repo.or.cz/r/fast-export.git /tmp/fast-export"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","_subversion"]],"x":"Subversion","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n\n如果你阅读过前面关于 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"然而，导入并不完美；因为花费太长时间了，你可能早已用其他方法完成导入操作。\n导入产生的第一个问题就是作者信息。\n在 Subversion 中，每一个人提交时都需要在系统中有一个用户，它会被记录在提交信息内。\n在之前章节的例子中几个地方显示了 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了获得 SVN 使用的作者名字列表，可以运行这个：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这会将日志输出为 XML 格式，然后保留作者信息行、去除重复、去除 XML 标记。\n（很显然这只会在安装了 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你可以将此文件提供给 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"反而它们看起来像是这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"不仅是 Author 字段更好看了，","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"之后，你应当做一些导入后的清理工作。\n第一步，你应当清理 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了将标签变为合适的 Git 标签，运行","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这会使原来在 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"接下来，将 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在所有的旧分支都是真正的 Git 分支，并且所有的旧标签都是真正的 Git 标签。\n最后一件要做的事情是，将你的新 Git 服务器添加为远程仓库并推送到上面。\n下面是一个将你的服务器添加为远程仓库的例子：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"因为想要上传所有分支与标签，你现在可以运行：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"通过以上漂亮、干净地导入操作，你的所有分支与标签都应该在新 Git 服务器上。","n":"p","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git push origin --all"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git remote add origin git@my-git-server:myrepository.git"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cp -Rf .git/refs/remotes/* .git/refs/heads/\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" rm -Rf .git/refs/remotes"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/remotes","n":"code","l":" 下剩余的引用移动为本地分支："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"remotes/origin/tags/","n":"code","l":" 里的远程分支引用变成真正的（轻量）标签。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cp -Rf .git/refs/remotes/origin/tags/* .git/refs/tags/\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" rm -Rf .git/refs/remotes/origin/tags"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 设置的奇怪的引用。\n首先移动标签，这样它们就是标签而不是奇怪的远程引用，然后你会移动剩余的分支这样它们就是本地的了。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-svn-id","n":"code","l":" 也不在了。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"commit 03a8785f44c8ea5cdb0e8834b7c8e6c469be2ff2\nAuthor: Scott Chacon <schacon@geemail.com>\nDate:   Sun May 3 00:12:22 2009 +0000\n\n    fixed install - go to trunk","n":"code"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"commit 37efa680e8473b615de980fa935944215428a35a\nAuthor: schacon <schacon@4c93b258-373f-11de-be05-5f7a86268029>\nDate:   Sun May 3 00:12:22 2009 +0000\n\n    fixed install - go to trunk\n\n    git-svn-id: https://my-project.googlecode.com/svn/trunk@94 4c93b258-373f-11de-\n    be05-5f7a86268029","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"my_project","n":"code","l":" 目录中应当有了一个更好的 Subversion 导入。\n并不像是下面这样的提交："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn clone http://my-project.googlecode.com/svn/ "},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"\\","n":"span","l":"\n      --authors-file=users.txt --no-metadata -s my_project"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 来帮助它更加精确地映射作者数据。\n也可以通过传递 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--no-metadata","n":"code","l":" 给 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"clone","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"init","n":"code","l":" 命令，告诉 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 不要包括 Subversion 通常会导入的元数据。\n这会使你的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"import","n":"code","l":" 命令看起来像这样："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"grep","n":"code","l":"、"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"sort","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"perl","n":"code","l":" 的机器上运行。）\n然后，将输出重定向到你的 users.txt 文件中，这样就可以在每一个记录后面加入对应的 Git 用户数据。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" svn log --xml | grep author | sort -u | "},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"\\","n":"span","l":"\n  perl -pe "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'s/.*>(.*?)<.*/$1 = /'","n":"span"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"schacon = Scott Chacon <schacon@geemail.com>\nselse = Someo Nelse <selse@geemail.com>","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"schacon","n":"code","l":"，比如 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"blame","n":"code","l":" 输出与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn log","n":"code","l":"。\n如果想要将上面的 Subversion 用户映射到一个更好的 Git 作者数据中，你需要一个 Subversion 用户到 Git 用户的映射。\n创建一个 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"users.txt","n":"code","l":" 的文件包含像下面这种格式的映射："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 的章节，可以轻松地使用那些指令来 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn clone","n":"code","l":" 一个仓库，停止使用 Subversion 服务器，推送到一个新的 Git 服务器，然后就可以开始使用了。\n如果你想要历史，可以从 Subversion 服务器上尽可能快地拉取数据来完成这件事（这可能会花费一些时间）。"},{"a":[["class","calibre6 pcalibre1 pcalibre"],["id","_作为客户端的_git"]],"x":"作为客户端的 Git","n":"h2","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\nGit 为开发者提供了如此优秀的体验，许多人已经找到了在他们的工作站上使用 Git 的方法，即使他们团队其余的人使用的是完全不同的 VCS。\n有许多这种可用的适配器，它们被叫做 “桥接”。\n下面我们将要介绍几个很可能会在实际中用到的桥接。","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 与 Subversion"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 与 Mercurial"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 与 Perforce"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 与 TFS"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","_git_与_tfs"]],"x":"Git 与 TFS","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n\nGit 在 Windows 开发者当中变得流行起来，如果你正在 Windows 上编写代码并且正在使用 Microsoft 的 Team Foundation Server (TFS)，这会是个好机会。\nTFS 是一个包含工作项目检测与跟踪、支持 Scrum 与其他流程管理方法、代码审核、版本控制的协作套件。\n这里有一点困惑：","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果发现你的团队在使用 TFVC 但是你更愿意使用 Git 作为版本控制客户端，这里为你准备了一个项目。","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","选择哪个工具"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","使用：git-tf"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","使用：git-tfs"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git-tf[s] 工作流程"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","工作流程：git-tf"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","工作流程：git-tfs"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 与 TFS 总结"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_与_tfs_总结"]],"x":"Git 与 TFS 总结","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-tf 与 Git-tfs 都是与 TFVC 服务器交互的很好的工具。\n它们允许你在本地使用 Git 的能力，避免与中央 TFVC 服务器频繁交流，使你做为一个开发者的生活更轻松，而不用强制整个团队迁移到 Git。\n如果你在 Windows 上工作（那很有可能你的团队正在使用 TFS），你可能会想要使用 git-tfs，因为它的功能更完整，但是如果你在其他平台工作，你只能使用略有限制的 git-tf。\n像本章中大多数工具一样，你应当使用其中的一个版本系统作为主要的，而使用另一个做为次要的 - 不管是 Git 还是 TFVC 都可以做为协作中心，但不是两者都用。","n":"p","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_工作流程_code_class_literal_git_tfs_code"]],"x":"工作流程：","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"让我们使用 git-tfs 来走一遍同样的情景。\n这是我们在 Git 仓库中 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"让我们看一下在我们工作时有没有人完成一些其它的工作：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"是的，那说明我们的同事增加了一个新的 TFVC 变更集，显示为新的 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"与 git-tf 相同，我们有两种基础选项来解决这个分叉历史问题：","n":"p","l":"\n"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在本例中，我们将要做一个 “深” 检入，也就是说每一个 Git 提交会变成一个 TFVC 变更集，所以我们想要变基。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在已经准备好通过检入我们的代码到 TFVC 服务器来完成贡献。\n我们这里将会使用 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意在每次成功检入到 TFVC 服务器后，git-tfs 是如何将剩余的工作变基到服务器上。\n这是因为它将 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"TFS 有许多与它的版本管理系统整合的功能，比如工作项目、指定审核者、封闭检入等等。\n仅仅通过命令行工具使用这些功能来工作是很笨重的，但是幸运的是 git-tfs 允许你轻松地运行一个图形化的检入工具：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"它看起来有点像这样：","n":"p","l":"\n"},{"a":[["class","image pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"对 TFS 用户来说这看起来很熟悉，因为它就是从 Visual Studio 中运行的同一个窗口。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-tfs 同样允许你从你的 Git 仓库控制 TFVC 分支。\n如同这个例子，让我们创建一个：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在 TFVC 中创建一个分支意味着增加一个使分支存在的变更集，这会映射为一个 Git 提交。\n也要注意的是 git-tfs ","n":"p","l":"\n"},{"a":[["class","calibre12 pcalibre1 pcalibre"]],"x":"创建","n":"strong","l":" 了 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tfs/featureBee","n":"code","l":" 远程分支，但是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"HEAD","n":"code","l":" 始终指向 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":"。\n如果你想要在新生成的分支上工作，那你也许应该通过从那次提交创建一个特性分支的方式使你新的提交基于 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"1d54865","n":"code","l":" 提交。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git tfs branch $/tfvc-test/featureBee\nThe name of the local branch will be "},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" featureBee\nC26 = 1d54865c397608c004a2cadce7296f5edc22a7e5\nPS> git log --oneline --graph --decorate --all\n* 1d54865 (tfs/featureBee) Creation branch $/myproject/featureBee\n* ff04e7c (HEAD, tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":", master) update code\n* 71a5ddc update readme\n* aea74a0 update documentation\n| * 44cd729 (tfs/featureA, featureA) Goodbye\n| * d202b53 Branched from $/tfvc-test/Trunk\n|/\n* c403405 Hello\n* b75da1a New project"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre9 pcalibre1 pcalibre"]],"x":"Figure 3. git-tfs 检入工具。","n":"figcaption","l":"\n"},{"a":[["alt","git-tfs 检入工具。"],["class","calibre8 pcalibre1 pcalibre"],["src","ezPJKgrMLI5iYpd7vlZT7E|aW1hZ2VzLzAwMTE1LmpwZWc=|"],["data-calibre-src","images/00115.jpeg"]],"n":"img","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git tfs checkintool\nPS> git tfs ct"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-tfs-id","n":"code","l":" 属性加入到提交信息的底部，这将会改变 SHA-1 校验和。\n这恰恰是有意设计的，没有什么事情可以担心了，但是你应该意识到发生了什么，特别是当你想要与其他人共享 Git 提交时。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git tfs rcheckin\nWorking with tfs remote"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":"\nFetching changes from TFS to minimize possibility of late conflict...\nStarting checkin of 5cec4ab4 "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'update readme'","n":"span","l":"\n add README.md\nC20 = 71a5ddce274c19f8fdc322b4f165d93d89121017\nDone with 5cec4ab4b213c354341f66c80cd650ab98dcf1ed, rebasing tail onto new TFS-commit...\nRebase done successfully.\nStarting checkin of b1bf0f99 "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'update code'","n":"span","l":"\n edit .git\\tfs\\"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":"\\workspace\\ConsoleApplication1/ConsoleApplication1/Program.cs\nC21 = ff04e7c35dfbe6a8f94e782bf5e0031cee8d103b\nDone with b1bf0f9977b2d48bad611ed4a03d3738df05ea5d, rebasing tail onto new TFS-commit...\nRebase done successfully.\nNo more to rcheckin.\nPS> git log --all --oneline --graph --decorate\n* ff04e7c (HEAD, tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":", master) update code\n* 71a5ddc update readme\n* aea74a0 update documentation\n| * 44cd729 (tfs/featureA, featureA) Goodbye\n| * d202b53 Branched from $/tfvc-test/Trunk\n|/\n* c403405 Hello\n* b75da1a New project"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"rcheckin","n":"code","l":" 命令将 HEAD 到第一个 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tfs","n":"code","l":" 远程分支间的每一个 Git 提交转换为一个 TFVC 变更集（"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"checkin","n":"code","l":" 命令只会创建一个变更集，有些类似于压缩 Git 提交）。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git rebase tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":"\nFirst, rewinding head to replay your work on top of it...\nApplying"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" update readme\nApplying"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" update code\nPS> git log --all --oneline --graph --decorate\n* 10a75ac (HEAD, master) update code\n* 5cec4ab update readme\n* aea74a0 (tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":") update documentation\n| * 44cd729 (tfs/featureA, featureA) Goodbye\n| * d202b53 Branched from $/tfvc-test/Trunk\n|/\n* c403405 Hello\n* b75da1a New project"},{"a":[["class","arabic pcalibre1 pcalibre"]],"x":"\n","n":"ol","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"通过合并来保留改动。","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"通过变基来保持历史是线性的。","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"aea74a0","n":"code","l":" 提交，而 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tfs/default","n":"code","l":" 远程分支已经被移除了。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git tfs fetch\nC19 = aea74a0313de0a391940c999e51c5c15c381d91d\nPS> git log --all --oneline --graph --decorate\n* aea74a0 (tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":") update documentation\n| * c3bd3ae (HEAD, master) update code\n| * d85e5a2 update readme\n|/\n| * 44cd729 (tfs/featureA, featureA) Goodbye\n| * d202b53 Branched from $/tfvc-test/Trunk\n|/\n* c403405 Hello\n* b75da1a New project"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git log --oneline --graph --all --decorate\n* c3bd3ae (HEAD, master) update code\n* d85e5a2 update readme\n| * 44cd729 (tfs/featureA, featureA) Goodbye\n| * d202b53 Branched from $/tfvc-test/Trunk\n|/\n* c403405 (tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":") Hello\n* b75da1a New project"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 分支上生成的几个新提交："},{"a":[["class","literal2 pcalibre1 pcalibre"]],"x":"git-tfs","n":"code"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_工作流程_code_class_literal_git_tf_code"]],"x":"工作流程：","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"假定你完成了一些工作，在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"我们想要拿到在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"看起来其他人也做了一些改动，现在我们有一个分叉的历史。\n这就是 Git 的优势，但是我们现在有两种处理的方式：","n":"p","l":"\n"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这是你的选择。\n在本例中，我们会进行变基：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在我们准备好生成一个检入来推送到 TFVC 服务器上了。\nGit-tf 给你一个将自上次修改（即 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"那有一个新标签 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这就是主要的工作流程。\n有一些你需要考虑的其他注意事项：","n":"p","l":"\n"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre10 pcalibre1 pcalibre"]],"x":"\n","n":"ul","l":"\n"},{"a":[["class","pcalibre7 calibre11 pcalibre1"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre7 calibre11 pcalibre1"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre7 calibre11 pcalibre1"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"如果你的团队的工作流程包括在 Git 中协作并定期与 TFVC 同步，只能使用其中的一个 Git 仓库连接到 TFVC。","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"协作时使用 TFVC 或 Git，而不是两者同时使用。\n同一个 TFVC 仓库的不同 git-tf 克隆会有不同的 SHA-1 校验和，这会导致无尽的头痛问题。","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"没有分支。\nGit-tf 同一时间只能从一个 TFVC 分支创建一个 Git 仓库。","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"TFS_C35348","n":"code","l":"，表明 TFVC 已经存储了一个相当于 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"5a0e25e","n":"code","l":" 提交的快照。\n要重点注意的是，不是每一个 Git 提交都需要在 TFVC 中存在一个相同的副本；例如 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"6eb3eb5","n":"code","l":" 提交，在服务器上并不存在。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git tf checkin -m "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'Updating readme and code'","n":"span","l":"\nUsername: domain\\user\nPassword:\nConnecting to TFS...\nChecking in to $/myproject: 100%, done.\nChecked commit 5a0e25e in as changeset 35348\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate --all\n* 5a0e25e (HEAD, tag: TFS_C35348, origin_tfs/tfs, master) update code\n* 6eb3eb5 update readme\n* 8ef06a8 (tag: TFS_C35320) just some text\n* d44b17a (tag: TFS_C35190) Goodbye\n* 126aa7b (tag: TFS_C35189)\n* 8f77431 (tag: TFS_C35178) FIRST\n* 0745a25 (tag: TFS_C35177) Created team project folder $/tfvctest via the \\\n          Team Project Creation Wizard"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--shallow","n":"code","l":" 选项，默认启用）以来所有的修改生成的一个单独的变更集以及为每一个 Git 提交（"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--deep","n":"code","l":"）生成的一个新的变更集。\n在本例中，我们将会创建一个变更集："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git rebase FETCH_HEAD\nFirst, rewinding head to replay your work on top of it...\nApplying: update readme\nApplying: update code\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate --all\n* 5a0e25e (HEAD, master) update code\n* 6eb3eb5 update readme\n* 8ef06a8 (tag: TFS_C35320, origin_tfs/tfs) just some text\n* d44b17a (tag: TFS_C35190) Goodbye\n* 126aa7b (tag: TFS_C35189)\n* 8f77431 (tag: TFS_C35178) FIRST\n* 0745a25 (tag: TFS_C35177) Created team project folder $/tfvctest via the \\\n          Team Project Creation Wizard"},{"a":[["class","arabic pcalibre1 pcalibre"]],"x":"\n","n":"ol","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"变基使我们的提交历史变成直线，这意味着我们有个选项可以将我们的每一个 Git 提交转换为一个 TFVC 变更集。\n因为这种方式为其他选项留下了可能，所以我们推荐你这样做；git-tf 可以很简单地通过 ","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git tf pull --rebase","n":"code","l":" 帮你达成目标。"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"像一名 Git 用户一样自然的生成一个合并提交（毕竟，那也是 ","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git pull","n":"code","l":" 做的），git-tf 可以通过一个简单的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git tf pull","n":"code","l":" 来帮你完成。\n然而，我们要注意的是，TFVC 却并不这样想，如果你推送合并提交那么你的历史在两边看起来都不一样，这会造成困惑。\n其次，如果你计划将所有你的改动提交为一次变更集，这可能是最简单的选择。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git tf fetch\nUsername: domain\\user\nPassword:\nConnecting to TFS...\nFetching $/myproject at latest changeset: 100%, done.\nDownloaded changeset 35320 as commit 8ef06a8. Updated FETCH_HEAD.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate --all\n* 8ef06a8 (tag: TFS_C35320, origin_tfs/tfs) just some text\n| * 4178a82 (HEAD, master) update code\n| * 9df2ae3 update readme\n|/\n* d44b17a (tag: TFS_C35190) Goodbye\n* 126aa7b (tag: TFS_C35189)\n* 8f77431 (tag: TFS_C35178) FIRST\n* 0745a25 (tag: TFS_C35177) Created team project folder $/tfvctest via the \\\n          Team Project Creation Wizard"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"4178a82","n":"code","l":" 提交的快照并将其推送到 TFVC 服务器。\n先说重要的：让我们看看自从上次连接后我们的队友是否进行过改动："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate --all\n* 4178a82 (HEAD, master) update code\n* 9df2ae3 update readme\n* d44b17a (tag: TFS_C35190, origin_tfs/tfs) Goodbye\n* 126aa7b (tag: TFS_C35189)\n* 8f77431 (tag: TFS_C35178) FIRST\n* 0745a25 (tag: TFS_C35177) Created team project folder $/tfvctest via the \\\n          Team Project Creation Wizard"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 中做了几次 Git 提交，然后准备将你的进度共享到服务器。\n这是我们的 Git 仓库："},{"a":[["class","literal2 pcalibre1 pcalibre"]],"x":"git-tf","n":"code"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_tf_s_工作流程"]],"x":"Git-tf[s] 工作流程","n":"h4","l":"\n"},{"a":[["class","admonition pcalibre1 pcalibre8"],["title","Note"],["type","note"]],"x":"\n","n":"aside","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"显然，接下来要做的事情就是要在项目中做一些工作。\nTFVC 与 TFS 有几个功能可能会增加你的工作流程的复杂性：","n":"p","l":"\n"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"出于简洁性的原因，我们这里介绍的是一种轻松的方式，回避并避免了大部分问题。","n":"p","l":"\n"},{"a":[["class","arabic pcalibre1 pcalibre"]],"x":"\n","n":"ol","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","calibre11 pcalibre1 pcalibre"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"TFS 有一个 “封闭” 检入的概念，TFS 构建-测试循环必须在检入被允许前成功完成。\n这使用了 TFVC 的 “shelve” 功能，我们不会在这里详述。\n  可以通过 git-tf 手动地模拟这个功能，并且 git-tfs 提供了封闭敏感的 ","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"checkintool","n":"code","l":" 命令。"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"要意识到 TFVC 允许用户从服务器上 “检出” 文件并锁定它们，这样其他人就无法编辑了。\n显然它不会阻止你在本地仓库中编辑它们，但是当推送你的修改到 TFVC 服务器时会出现问题。","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"TFVC 无法表示特性分支，这会增加一点复杂度。\n这会导致需要以 ","n":"span","l":"\n"},{"a":[["class","calibre12 pcalibre1 pcalibre"]],"x":"非常","n":"strong","l":" 不同的方式使用 TFVC 与 Git 表示的分支。"},{"a":[["class","content1 pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"无论你使用哪个工具，都需要先设置几个 Git 配置选项来避免一些问题。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","source1 pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git config set --local core.ignorecase=true\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git config set --local core.autocrlf=false"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_使用_code_class_literal_git_tfs_code"]],"x":"使用：","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-tfs 克隆行为略为不同。\n观察：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"让我们看一下最终的 Git 仓库：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"有两个本地分支，","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"另一件需要注意的事情是在提交信息中的 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-tfs-id:","n":"code","l":" 行。\nGit-tfs 使用这些标记而不是标签来关联 TFVC 变更集与 Git 提交。\n有一个潜在的问题是 Git 提交在推送到 TFVC 前后会有不同的 SHA-1 校验和。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"featureA","n":"code","l":"，分别代表着克隆（TFVC 中的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"Trunk","n":"code","l":"）与子分支（TFVC 中的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"featureA","n":"code","l":"）的初始状态。\n也可以看到 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tfs","n":"code","l":" “remote” 也有一对引用："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"default","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"featureA","n":"code","l":"，代表 TFVC 分支。\nGit-tfs 映射从 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"tfs/default","n":"code","l":" 克隆的分支，其他的会有它们自己的名字。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git log --oneline --graph --decorate --all\n* 44cd729 (tfs/featureA, featureA) Goodbye\n* d202b53 Branched from $/tfvc-test/Trunk\n* c403405 (HEAD, tfs/"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"default","n":"span","l":", master) Hello\n* b75da1a New project\nPS> git log -1\ncommit c403405f4989d73a2c3c119e79021cb2104ce44a\nAuthor"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" Ben Straub <ben@straub.cc>\nDate"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"   Fri Aug 1 03"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"41"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"59 2014 +0000\n\n    Hello\n\n    git-tfs-id"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" [https"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"//username.visualstudio.com/DefaultCollection]$/myproject/Trunk;C16"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--with-branches","n":"code","l":" 选项。\nGit-tfs 能够映射 TFVC 分支到 Git 分支，这个标记告诉它为每一个 TFVC 分支建立一个本地的 Git 分支。\n强烈推荐曾经在 TFS 中新建过分支或合并过分支的仓库使用这个标记，但是如果使用的服务器的版本比 TFS 2010 更老 - 在那个版本前，“分支” 只是文件夹，所以 git-tfs 无法将它们与普通文件夹区分开。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span","l":"PS> git tfs clone --with-branches \\\n    https"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"//username.visualstudio.com/DefaultCollection \\\n    $/project/Trunk project_git\nInitialized empty Git repository "},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"in","n":"span","l":" C"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"/Users/ben/project_git/.git/\nC15 = b75da1aba1ffb359d00e85c52acb261e4586b0c9\nC16 = c403405f4989d73a2c3c119e79021cb2104ce44a\nTfs branches found"},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":"\n- $/tfvc-test/featureA\nThe name of the local branch will be "},{"a":[["class","pcalibre1 calibre28 pcalibre"]],"x":":","n":"span","l":" featureA\nC17 = d202b53f67bde32171d5078968c644e562f1c439\nC18 = 44cd729d8df868a8be20438fdeeefb961958b674"},{"a":[["class","literal2 pcalibre1 pcalibre"]],"x":"git-tfs","n":"code"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_使用_code_class_literal_git_tf_code"]],"x":"使用：","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"和其它任何 Git 项目一样，你要做的第一件事是克隆。\n使用 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"第一个参数是一个 TFVC 集的 URL，第二个参数类似于 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这会创建一个完整功能的 Git 仓库：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这叫做 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果愿意多花一些时间，使用 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意名字类似 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"TFS_C35189","n":"code","l":" 的标签；这是一个帮助你知道 Git 提交与 TFVC 变更集关联的功能。\n这是一种优雅的表示方式，因为通过一个简单的 log 命令就可以看到你的提交是如何与 TFVC 中已存在快照关联起来的。\n它们并不是必须的（并且实际上可以使用 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git config git-tf.tag false","n":"code","l":" 来关闭它们）- git-tf 会在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".git/git-tf","n":"code","l":" 文件中保存真正的提交与变更集的映射。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git tf clone https://tfs.codeplex.com:443/tfs/TFS13 $/myproject/Main "},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"\\","n":"span","l":"\n  project_git --deep\nUsername: domain\\user\nPassword:\nConnecting to TFS...\nCloning $/myproject into /tmp/project_git: 100%, done.\nCloned 4 changesets. Cloned last changeset 35190 as d44b17a\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd project_git\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --all --oneline --decorate\nd44b17a (HEAD, tag: TFS_C35190, origin_tfs/tfs, master) Goodbye\n126aa7b (tag: TFS_C35189)\n8f77431 (tag: TFS_C35178) FIRST\n0745a25 (tag: TFS_C35177) Created team project folder $/tfvctest via the \\\n        Team Project Creation Wizard"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--deep","n":"code","l":" 选项克隆整个项目历史可能更有价值。"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"浅","n":"em","l":" 克隆，意味着只下载了最新的变更集。\nTFVC 并未设计成为每一个客户端提供一份全部历史记录的拷贝，所以 git-tf 默认行为是获得最新的版本，这样更快一些。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd project_git\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --all --oneline --decorate\n512e75a (HEAD, tag: TFS_C35190, origin_tfs/tfs, master) Checkin message"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"$/project/branch","n":"code","l":" 的形式，第三个参数是将要创建的本地 Git 仓库路径（最后一项可以省略）。\nGit-tf 同一时间只能工作在一个分支上；如果你想要检入一个不同的 TFVC 分支，你需要从那个分支克隆一份新的。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git tf clone https://tfs.codeplex.com:443/tfs/TFS13 $/myproject/Main project_git"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-tf","n":"code","l":" 克隆看起来像这样："},{"a":[["class","literal2 pcalibre1 pcalibre"]],"x":"git-tf","n":"code"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_选择哪个工具"]],"x":"选择哪个工具","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n实际上，这里有两个工具：git-tf 与 git-tfs。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-tfs （可以在 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-tf（主页在 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"所以每个工具都有优点和缺点，每个工具都有它适用的情况。\n我们在本书中将会介绍它们两个的基本用法。","n":"p","l":"\n"},{"a":[["class","admonition pcalibre1 pcalibre8"],["title","Note"],["type","note"]],"x":"\n","n":"aside","l":"\n"},{"a":[["class","content1 pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你需要有一个基于 TFVC 的仓库来执行后续的指令。\n现实中它们并没有 Git 或 Subversion 仓库那样多，所以你可能需要创建一个你自己的仓库。\nCodeplex (","n":"p","l":"\n"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","https://www.codeplex.com"],["target","_blank"],["rel","noopener noreferrer"]],"x":"https://www.codeplex.com","n":"a","l":") 或 Visual Studio Online ("},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","http://www.visualstudio.com"],["target","_blank"],["rel","noopener noreferrer"]],"x":"http://www.visualstudio.com","n":"a","l":") 都是非常好的选择。"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","https://gittf.codeplex.com"],["target","_blank"],["rel","noopener noreferrer"]],"x":"https://gittf.codeplex.com","n":"a","l":"）是一个 Java 项目，因此它可以运行在任何一个有 Java 运行时环境的电脑上。\n它通过 JGit（一个 Git 的 JVM 实现）来与 Git 仓库交互，这意味着事实上它没有 Git 功能上的限制。\n然而，相对于 git-tfs 它对 TFVC 的支持是有限的 - 例如，它不支持分支。"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","https://github.com/git-tfs/git-tfs"],["target","_blank"],["rel","noopener noreferrer"]],"x":"https://github.com/git-tfs/git-tfs","n":"a","l":" 找到）是一个 .NET 项目，它只能运行在 Windows 上（截至文章完成时）。\n为了操作 Git 仓库，它使用了 libgit2 的 .NET 绑定，一个可靠的面向库的 Git 实现，十分灵活且性能优越。\nLibgit2 并不是一个完整的 Git 实现，为了弥补差距 git-tfs 实际上会调用 Git 命令行客户端来执行某些操作，因此在操作 Git 仓库时并没有任何功能限制。\n因为它使用 Visual Studio 程序集对服务器进行操作，所以它对 TFVC 的支持非常成熟。\n这并不意味着你需要接触那些程序集，但是意味着你需要安装 Visual Studio 的一个最近版本（2010 之后的任何版本，包括 2012 之后的 Express 版本），或者 Visual Studio SDK。"},{"a":[["class","calibre12 pcalibre1 pcalibre"]],"x":"TFS","n":"strong","l":" 是服务器，它支持通过 Git 与它们自定义的 VCS 来管理源代码，这被他们称为 "},{"a":[["class","calibre12 pcalibre1 pcalibre"]],"x":"TFVC","n":"strong","l":"（Team Foundation Version Control）。\nGit 支持 TFS（自 2013 版本起）的部分新功能，所以在那之前所有工具都将版本控制部分称为 “TFS”，即使实际上他们大部分时间都在与 TFVC 工作。"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","_git_与_perforce"]],"x":"Git 与 Perforce","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n\n在企业环境中 Perforce 是非常流行的版本管理系统。\n它大概起始于 1995 年，这使它成为了本章中介绍的最古老的系统。\n就其本身而言，它设计时带有当时时代的局限性；它假定你始终连接到一个单独的中央服务器，本地磁盘只保存一个版本。\n诚然，它的功能与限制适合几个特定的问题，但实际上，在很多情况下，将使用 Perforce 的项目换做使用 Git 会更好。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你决定混合使用 Perforce 与 Git 这里有两种选择。\n第一个我们要介绍的是 Perforce 官方制作的 “Git Fusion” 桥接，它可以将 Perforce 仓库中的子树表示为一个可读写的 Git 仓库。\n第二个是 git-p4，一个客户端桥接允许你将 Git 作为 Perforce 的客户端使用，而不用在 Perforce 服务器上做任何重新的配置。","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git Fusion"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git-p4"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 与 Perforce 总结"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_与_perforce_总结"]],"x":"Git 与 Perforce 总结","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-p4 将与 Perforce 服务器工作时使用 Git 工作流成为可能，并且它非常擅长这点。\n然而，需要记住的重要一点是 Perforce 负责源头，而你只是在本地使用 Git。\n在共享 Git 提交时要相当小心：如果你有一个其他人使用的远程仓库，不要在提交到 Perforce 服务器前推送任何提交。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果想要为源码管理自由地混合使用 Perforce 与 Git 作为客户端，可以说服服务器管理员安装 Git Fusion，Git Fusion 使 Git 作为 Perforce 服务器的首级版本管理客户端。","n":"p","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_p4"]],"x":"Git-p4","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\nGit-p4 是 Git 与 Perforce 之间的双向桥接。\n它完全运行在你的 Git 仓库内，所以你不需要任何访问 Perforce 服务器的权限（当然除了用户验证）。\nGit-p4 并不像 Git Fusion 一样灵活或完整，但是它允许你在无需修改服务器环境的情况下，做大部分想做的事情。","n":"p","l":"\n"},{"a":[["class","admonition pcalibre1 pcalibre8"],["title","Note"],["type","note"]],"x":"\n","n":"aside","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","设置"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","开始"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","工作流程"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","分支"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","r_git_p4_branches"]],"x":"分支","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你的 Perforce 项目有多个分支，你并不会不走运；git-p4 可以以一种类似 Git 的方式来处理那种情况。\n假定你的 Perforce 仓库平铺的时候像这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"并且假定你有一个 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-p4 可以自动地检测到这种情形并做正确的事情：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意在仓库路径中的 “@all” 说明符；那会告诉 git-p4 不仅仅只是克隆那个子树最新的变更集，更包括那些路径未接触的所有变更集。\n这有点类似于 Git 的克隆概念，但是如果你工作在一个具有很长历史的项目，那么它会花费一段时间。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"设置 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果我们现在运行 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了创建与整合分支，你不得不使用一个 Perforce 客户端。\nGit-p4 只能同步或提交已有分支，并且它一次只能做一个线性的变更集。\n如果你在 Git 中合并两个分支并尝试提交新的变更集，所有这些会被记录为一串文件修改；关于哪个分支参与的元数据在整合中会丢失。","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git checkout -b dev p4/project/dev","n":"code","l":" 并且做一些提交，在运行 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 submit","n":"code","l":" 时 git-p4 会聪明地选择正确的分支。\n不幸的是，git-p4 不能混用 shallow 克隆与多个分支；如果你有一个巨型项目并且想要同时工作在不止一个分支上，可能不得不针对每一个你想要提交的分支运行一次 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 clone","n":"code","l":"。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-p4.branchList","n":"code","l":" 配置选项为 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"main:dev","n":"code","l":" 告诉 git-p4 那个 “main” 与 “dev” 都是分支，第二个是第一个的子分支。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git init project\nInitialized empty Git repository in /tmp/project/.git/\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd project\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git config git-p4.branchList main:dev\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git clone --detect-branches //depot/project@all ."},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--detect-branches","n":"code","l":" 标记告诉 git-p4 使用 Perforce 的分支规范来映射到 Git 的引用中。\n如果这些映射不在 Perforce 服务器中（使用 Perforce 的一种完美有效的方式），你可以告诉 git-p4 分支映射是什么，然后你会得到同样的结果："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 clone --detect-branches //depot/project@all\nImporting from //depot/project@all into project\nInitialized empty Git repository in /private/tmp/project/.git/\nImporting revision 20 (50%)\n    Importing new branch project/dev\n\n    Resuming with change 20\nImporting revision 22 (100%)\nUpdated branches: main dev\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd project; git log --oneline --all --graph --decorate\n* eae77ae (HEAD, p4/master, p4/HEAD, master) main\n| * 10d55fb (p4/project/dev) dev\n| * a43cfae Populate //depot/project/main/... //depot/project/dev/....\n|/\n* 2b83451 Project init"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"//depot/project/main/... //depot/project/dev/...","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dev","n":"code","l":" 分支，有一个视图规格像下面这样："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"//depot\n  └── project\n      ├── main\n      └── dev","n":"code"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_工作流程_3"]],"x":"工作流程","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"好了，让我们开始一些工作。\n假设你已经在一个非常重要的功能上做了一些工作，然后准备好将它展示给团队中的其他人。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"我们已经生成了两次新提交并已准备好推送它们到 Perforce 服务器。\n让我们检查一下今天其他人是否做了一些工作：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"看起来他们做了，","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"从输出中可能大概得知，","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在我们的历史再次是线性的，我们准备好我们的改动贡献回 Perforce。\n","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"除了结尾 git-p4 给我们的帮助性的提示，其它的与你运行 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-p4 帮助性地将 Git 的提交注释导入到 Perforce 变更集的内容，这样所有我们必须做的就是保存并退出，两次（每次一个提交）。\n这会使 shell 输出看起来像这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"结果恰如我们只是做了一次 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意在这个过程中每一个 Git 提交都会被转化为一个 Perforce 变更集；如果想要将它们压缩成为一个单独的提交，可以在运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"当尝试提交一次合并提交时会发生什么？\n让我们尝试一下。\n这是我们可能会遇到的一种情形：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 与 Perforce 历史在 775a46f 后分叉了。\nGit 这边有两次提交，然后一次与 Perforce 头部的合并提交，还有另一个提交。\n我们将会尝试提交这些到 Perforce 那边单独的变更集之上。\n让我们看看如果尝试这样提交会发生什么：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"我们的历史变成线性了，就像在提交前刚刚变基过（实际上也是这样）。\n这意味着你可以在 Git 这边自由地创建、工作、扔掉与合并分支而不用害怕你的历史会变得与 Perforce 不兼容。\n如果你可以变基它，你就可以将它贡献到 Perforce 服务器。","n":"p","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 submit\n[…]\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --all --graph --decorate\n* dadbd89 (HEAD, p4/master, p4/HEAD, master) Correct email address\n* 1b79a80 Table borders: yes please\n* 0097235 Trademark\n* c4689fc Grammar fix\n* 775a46f Change page title\n* 05f1ade Update link\n* 75cd059 Update copyright\n* 70eaf78 Initial import of //depot/www/live/ from the state at revision #head"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"-n","n":"code","l":" 标记是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--dry-run","n":"code","l":" 的缩写，将会报告如果提交命令真的运行会发生什么。\n这本例中，它看起来像是我们会创建三个 Perforce 变更集，对应着不在 Perforce 服务器端的三次非合并提交。\n那听起来像是我们想要的，让我们看看它会如何做："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 submit -n\nPerforce checkout for depot path //depot/www/live/ located at /Users/ben/john_bens-mbp_8487/john_bens-mbp_8487/depot/www/live/\nWould synchronize p4 checkout in /Users/ben/john_bens-mbp_8487/john_bens-mbp_8487/depot/www/live/\nWould apply\n  b4959b6 Trademark\n  cbacd0a Table borders: yes please\n  3be6fd8 Correct email address"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --all --graph --decorate\n* 3be6fd8 (HEAD, master) Correct email address\n*   1dcbf21 Merge remote-tracking branch 'p4/master'\n|\\\n| * c4689fc (p4/master, p4/HEAD) Grammar fix\n* | cbacd0a Table borders: yes please\n* | b4959b6 Trademark\n|/\n* 775a46f Change page title\n* 05f1ade Update link\n* 75cd059 Update copyright\n* 70eaf78 Initial import of //depot/www/live/ from the state at revision #head"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log -1\ncommit 775a46f630d8b46535fc9983cf3ebe6b9aa53145\nAuthor: John Doe <john@example.com>\nDate:   Sun Aug 31 10:31:44 2014 -0800\n\n    Change page title\n\n    [git-p4: depot-paths = \"//depot/www/live/\": change = 12144]"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 submit","n":"code","l":" 前进行一次交互式变基。\n同样注意的是所有被转化为变更集的提交的 SHA-1 校验和都改变了；这是因为 git-p4 在每一个转化的提交增加一行到提交注释结尾："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git push","n":"code","l":"，就像是应当实际发生的最接近的类比。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 submit\nPerforce checkout for depot path //depot/www/live/ located at /Users/ben/john_bens-mbp_8487/john_bens-mbp_8487/depot/www/live/\nSynchronizing p4 checkout...\n... - file(s) up-to-date.\nApplying dbac45b Update link\n//depot/www/live/index.html#4 - opened for edit\nChange 12143 created with 1 open file(s).\nSubmitting change 12143.\nLocking 1 files ...\nedit //depot/www/live/index.html#5\nChange 12143 submitted.\nApplying 905ec6a Change page title\n//depot/www/live/index.html#5 - opened for edit\nChange 12144 created with 1 open file(s).\nSubmitting change 12144.\nLocking 1 files ...\nedit //depot/www/live/index.html#6\nChange 12144 submitted.\nAll commits applied!\nPerforming incremental import into refs/remotes/p4/master git branch\nDepot paths: //depot/www/live/\nImport destination: refs/remotes/p4/master\nImporting revision 12144 (100%)\nRebasing the current branch onto remotes/p4/master\nFirst, rewinding head to replay your work on top of it...\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --all --graph --decorate\n* 775a46f (HEAD, p4/master, p4/HEAD, master) Change page title\n* 05f1ade Update link\n* 75cd059 Update copyright\n* 70eaf78 Initial import of //depot/www/live/ from the state at revision #head"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4 submit","n":"code","l":" 后看到的内容大多相同。\n当提交或变更集需要一个名字时 git-p4 会分别尝试使用你的 Git 与 Perforce 设置，但是有些情况下你会想要覆盖默认行为。\n例如，如果你正导入的提交是由没有 Perforce 用户账户的贡献者编写的，你还是会想要最终的变更集看起来像是他们写的（而不是你）。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":" A Perforce Change Specification.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Change:      The change number. "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'new'","n":"span","l":" on a new changelist.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Date:        The date this specification was last modified.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Client:      The client on which the changelist was created.  Read-only.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  User:        The user who created the changelist.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Status:      Either "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'pending'","n":"span","l":" or "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'submitted'","n":"span","l":". Read-only.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Type:        Either "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'public'","n":"span","l":" or "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'restricted'","n":"span","l":". Default is "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'public'","n":"span","l":".\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Description: Comments about the changelist.  Required.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Jobs:        What opened jobs are to be closed by this changelist.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"               You may delete jobs from this list.  (New changelists only.)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"  Files:       What opened files from the default changelist are to be added\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"               to this changelist.  You may delete files from this list.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"               (New changelists only.)\n\nChange:  new\n\nClient:  john_bens-mbp_8487\n\nUser: john\n\nStatus:  new\n\nDescription:\n   Update link\n\nFiles:\n   //depot/www/live/index.html   # edit\n\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"####### git author ben@straub.cc does not match your p4 account.","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"####### Use option --preserve-user to modify authorship.","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"####### Variable git-p4.skipUserNameCheck hides this message.","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"####### everything below this line is just the diff #######","n":"span","l":"\n--- //depot/www/live/index.html  2014-08-31 18:26:05.000000000 0000\n+++ /Users/ben/john_bens-mbp_8487/john_bens-mbp_8487/depot/www/live/index.html   2014-08-31 18:26:05.000000000 0000\n@@ -60,7 +60,7 @@\n </td>\n <td valign=top>\n Source and documentation for\n-<a href=\"http://www.perforce.com/jam/jam.html\">\n+<a href=\"jam.html\">\n Jam/MR</a>,\n a software build tool.\n </td>"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 submit","n":"code","l":" 命令会尝试在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4/master","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 之间的每一个 Git 提交创建一个新的 Perforce 修订版本。\n运行它会带我们到最爱的编辑器，文件内容看起来像是这样："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 rebase","n":"code","l":" 是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git p4 sync","n":"code","l":" 接着 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git rebase p4/master","n":"code","l":" 的快捷方式。\n它比那更聪明一些，特别是工作在多个分支时，但这是一个进步。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 rebase\nPerforming incremental import into refs/remotes/p4/master git branch\nDepot paths: //depot/www/live/\nNo changes to import!\nRebasing the current branch onto remotes/p4/master\nFirst, rewinding head to replay your work on top of it...\nApplying: Update link\nApplying: Change page title\n index.html | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4/master","n":"code","l":" 已经分叉了。\nPerforce 的分支系统一点也 "},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"不","n":"em","l":" 像 Git 的，所以提交合并提交没有任何意义。\nGit-p4 建议变基你的提交，它甚至提供了一个快捷方式来这样做："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 sync\ngit p4 sync\nPerforming incremental import into refs/remotes/p4/master git branch\nDepot paths: //depot/www/live/\nImport destination: refs/remotes/p4/master\nImporting revision 12142 (100%)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --all --graph --decorate\n* 75cd059 (p4/master, p4/HEAD) Update copyright\n| * 018467c (HEAD, master) Change page title\n| * c0fb617 Update link\n|/\n* 70eaf78 Initial import of //depot/www/live/ from the state at revision #head"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --all --graph --decorate\n* 018467c (HEAD, master) Change page title\n* c0fb617 Update link\n* 70eaf78 (p4/master, p4/HEAD) Initial import of //depot/www/live/ from the state at revision #head"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_开始_3"]],"x":"开始","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"像在 Git 中的任何事情一样，第一个命令就是克隆：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这样会创建出一种在 Git 中名为 “shallow” 克隆；只有最新版本的 Perforce 被导入至 Git；记住，Perforce 并未被设计成给每一个用户一个版本。\n使用 Git 作为 Perforce 客户端这样就足够了，但是为了其他目的的话这样可能不够。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"完成之后，我们就有一个全功能的 Git 仓库：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意有一个 “p4” 远程代表 Perforce 服务器，但是其他东西看起来就像是标准的克隆。\n实际上，这有一点误导；其实远程仓库并不存在。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在当前仓库中并不存在任何远程仓库。\nGit-p4 创建了一些引用来代表服务器的状态，它们看起来类似 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git log","n":"code","l":" 显示的远程引用，但是它们并不被 Git 本身管理，并且你无法推送它们。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git remote -v"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd myproject\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --all --graph --decorate\n* 70eaf78 (HEAD, p4/master, p4/HEAD, master) Initial import of //depot/www/live/ from the state at revision #head"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git p4 clone //depot/www/live www-shallow\nImporting from //depot/www/live into www-shallow\nInitialized empty Git repository in /private/tmp/www-shallow/.git/\nDoing initial import of //depot/www/live/ from revision #head into refs/remotes/p4/master"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_设置_3"]],"x":"设置","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"出于演示的目的，我们将会从上面演示的 Git Fusion OVA 运行 Perforce 服务器，但是我们会绕过 Git Fusion 服务器然后直接进行 Perforce 版本管理。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了使用 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" export P4PORT=10.0.1.254:1666\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" export P4USER=john"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4","n":"code","l":" 命令行客户端（git-p4 依赖项），你需要设置两个环境变量："},{"a":[["class","content1 pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了与 git-p4 一起工作需要在你的 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"PATH","n":"code","l":" 环境变量中的某个目录中有 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4","n":"code","l":" 工具。\n在写这篇文章的时候，它可以在 "},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","http://www.perforce.com/downloads/Perforce/20-User"],["target","_blank"],["rel","noopener noreferrer"]],"x":"http://www.perforce.com/downloads/Perforce/20-User","n":"a","l":" 免费获得。"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","r_p4_git_fusion"]],"x":"Git Fusion","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\nPerforce 提供了一个叫作 Git Fusion 的产品（可在 ","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","设置"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Fusion 配置"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","工作流程"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git-Fusion 总结"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_git_fusion_总结"]],"x":"Git-Fusion 总结","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你有（或者能获得）接触你的 Perforce 服务器的权限，那么 Git Fusion 是使 Git 与 Perforce 互相交流的很好的方法。\n这里包含了一点配置，但是学习曲线并不是很陡峭。\n这是本章中其中一个不会出现无法使用 Git 全部能力的警告的章节。\n这并不是说扔给 Perforce 任何东西都会高兴 - 如果你尝试重写已经推送的历史，Git Fusion 会拒绝它 - 虽然 Git Fusion 尽力让你感觉是原生的。\n你甚至可以使用 Git 子模块（尽管它们对 Perforce 用户看起来很奇怪），合并分支（在 Perforce 这边会被记录了一次整合）。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果不能说服你的服务器管理员设置 Git Fusion，依然有一种方式来一起使用这两个工具。","n":"p","l":"\n"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_工作流程_2"]],"x":"工作流程","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Perforce Git Fusion 是在 Perforce 与 Git 版本控制间双向的桥接。\n让我们看一下在 Git 这边工作是什么样的感觉。\n假定我们在 “Jam” 项目中使用上述的配置文件映射了，可以这样克隆：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"当首次这样做时，会花费一些时间。\n这里发生的是 Git Fusion 会将在 Perforce 历史中所有合适的变更集转换为 Git 提交。\n这发生在服务器端本地，所以会相当快，但是如果有很多历史，那么它还是会花费一些时间。\n后来的抓取会做增量转换，所以会感觉更像 Git 的本地速度。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如你所见，我们的仓库看起来像之前使用过的任何一个 Git 仓库了。\n这里有三个分支，Git 已经帮助创建了一个跟踪 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"我们有两个新提交。\n现在我们检查下是否有其他人在工作：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"看起来有人在工作！\n从这个视图来看你并不知道这点，但是 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 认为它成功了。\n让我们从 Perforce 的视角看一下 ","n":"p","l":"\n"},{"a":[["class","image pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你在之前从未看过这个视图，它似乎让人困惑，但是它显示出了作为 Git 历史图形化查看器相同的概念。\n我们正在查看 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"还要注意的一件事是这个图看起来很像 Git 历史中的图。\nPerforce 没有存储 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这些大多数发生在后台，但是最终结果是团队中的一个人可以使用 Git，另一个可以使用 Perforce，而所有人都不知道其他人的选择。","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"1","n":"code","l":" 和 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"2","n":"code","l":" 提交的命名分支，所以它在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".git-fusion","n":"code","l":" 目录中生成了一个 “anonymous” 分支来保存它。\n这也会在 Git 命名分支不对应 Perforce 命名分支时发生（稍后你可以使用配置文件来映射它们到 Perforce 分支）。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"README","n":"code","l":" 文件的历史，所以左上角的目录树只显示那个文件在不同分支的样子。\n右上方，我们有不同版本文件关系的可视图，这个可视图的全局视图在右下方。\n视图中剩余的部分显示出选择版本的详细信息（在这个例子中是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"2","n":"code","l":"）"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre9 pcalibre1 pcalibre"]],"x":"Figure 2. Git 推送后的 Perforce 版本图","n":"figcaption","l":"\n"},{"a":[["alt","Git 推送后的 Perforce 版本图。"],["class","calibre8 pcalibre1 pcalibre"],["src","ezPJKgrMLI5iYpd7vlZT7E|aW1hZ2VzLzAwMTY2LmpwZWc=|"],["data-calibre-src","images/00166.jpeg"]],"n":"img","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"README","n":"code","l":" 文件的历史，使用 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4v","n":"code","l":" 的版本图功能。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git merge origin/master\nAuto-merging README\nMerge made by the 'recursive' strategy.\n README | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git push\nCounting objects: 9, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (9/9), done.\nWriting objects: 100% (9/9), 917 bytes | 0 bytes/s, done.\nTotal 9 (delta 6), reused 0 (delta 0)\nremote: Perforce: 100% (3/3) Loading commit tree into memory...\nremote: Perforce: 100% (5/5) Finding child commits...\nremote: Perforce: Running git fast-export...\nremote: Perforce: 100% (3/3) Checking commits...\nremote: Processing will continue even if connection is closed.\nremote: Perforce: 100% (3/3) Copying changelists...\nremote: Perforce: Submitting new Git commit objects to Perforce: 4\nTo https://10.0.1.254/Jam\n   6afeb15..89cba2b  master -> master"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"6afeb15","n":"code","l":" 提交确实是使用 Perforce 客户端创建的。\n从 Git 的视角看它仅仅只是另一个提交，准确地说是一个点。\n让我们看看 Perforce 服务器如何处理一个合并提交："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git fetch\nremote: Counting objects: 5, done.\nremote: Compressing objects: 100% (3/3), done.\nremote: Total 3 (delta 2), reused 0 (delta 0)\nUnpacking objects: 100% (3/3), done.\nFrom https://10.0.1.254/Jam\n   d254865..6afeb15  master     -> origin/master\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --decorate --graph --all\n* 6afeb15 (origin/master, origin/HEAD) Update copyright\n| * cfd46ab (HEAD, master) Add documentation for new feature\n| * a730d77 Whitespace\n|/\n* d254865 Upgrade to latest metrowerks on Beos -- the Intel one.\n* bd2f54a Put in fix for jam's NT handle leak.\n[...]"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":" ...\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --decorate --graph --all\n* cfd46ab (HEAD, master) Add documentation for new feature\n* a730d77 Whitespace\n* d254865 (origin/master, origin/HEAD) Upgrade to latest metrowerks on Beos -- the Intel one.\n* bd2f54a Put in fix for jam's NT handle leak.\n[...]"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"origin/master","n":"code","l":" 的本地 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 分支。\n让我们做一些工作，创建几个新提交："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git clone https://10.0.1.254/Jam\nCloning into 'Jam'...\nUsername for 'https://10.0.1.254': john\nPassword for 'https://ben@10.0.1.254':\nremote: Counting objects: 2070, done.\nremote: Compressing objects: 100% (1704/1704), done.\nReceiving objects: 100% (2070/2070), 1.21 MiB | 0 bytes/s, done.\nremote: Total 2070 (delta 1242), reused 0 (delta 0)\nResolving deltas: 100% (1242/1242), done.\nChecking connectivity... done.\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git branch -a\n* master\n  remotes/origin/HEAD -> origin/master\n  remotes/origin/master\n  remotes/origin/rel2.1\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --decorate --graph --all\n* 0a38c33 (origin/rel2.1) Create Jam 2.1 release branch.\n| * d254865 (HEAD, origin/master, origin/HEAD, master) Upgrade to latest metrowerks on Beos -- the Intel one.\n| * bd2f54a Put in fix for jam's NT handle leak.\n| * c0f29e7 Fix URL in a jam doc\n| * cc644ac Radstone's lynx port.\n[...]"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_fusion_配置"]],"x":"Fusion 配置","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"一旦安装了 Git Fusion，你会想要调整配置。\n使用你最爱的 Perforce 客户端做这件事实际上相当容易；只需要映射 Perforce 服务器上的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这里我们并不会深入介绍这些选项的含义，但是要注意这是一个 INI 格式的文本文件，就像 Git 的配置。\n这个文件指定了全局选项，但它可以被仓库特定的配置文件覆盖，像是 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这是一个 Perforce 分支与一个 Git 分支的映射。\n这个区块可以被命名成你喜欢的名字，只要保证名字是唯一的即可。\n","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"通过这种方式，如果正常工作空间映射包含对目录结构的修改，可以将其复制为一个 Git 仓库。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"最后一个我们讨论的文件是 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"每一行的格式都是 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"最后两行从创建的 Git 提交中掩盖了 Bob 与 Joe 的真实名字与邮箱地址。\n当你想要将一个内部项目开源，但不想将你的雇员目录公布到全世界时这很不错。\n注意邮箱地址与全名需要是唯一的，除非想要所有的 Git 提交都属于一个虚构的作者。","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"<user> <email> \"<full name>\"","n":"code","l":"，创建了一个单独的用户映射。\n前两行映射不同的邮箱地址到同一个 Perforce 用户账户。\n当使用几个不同的邮箱地址（或改变邮箱地址）生成 Git 提交并且想要让他们映射到同一个 Perforce 用户时这会很有用。\n当从一个 Perforce 变更集创建一个 Git 提交时，第一个匹配 Perforce 用户的行会被用作 Git 作者信息。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"x":"john john@example.com \"John Doe\"\njohn johnny@appleseed.net \"John Doe\"\nbob employeeX@example.com \"Anon X. Mouse\"\njoe employeeY@example.com \"Anon Y. Mouse\"","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"users/p4gf_usermap","n":"code","l":"，它将 Perforce 用户映射到 Git 用户，但你可能不会需要它。\n当从一个 Perforce 变更集转换为一个 Git 提交时，Git Fusion 的默认行为是去查找 Perforce 用户，然后把邮箱地址与全名存储在 Git 的 author/commiter 字段中。\n当反过来转换时，默认的行为是根据存储在 Git 提交中 author 字段中的邮箱地址来查找 Perforce 用户，然后以该用户提交变更集（以及权限的应用）。\n大多数情况下，这个行为工作得很好，但是考虑下面的映射文件："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[multi-project-mapping]","n":"span","l":"\ngit-branch-name = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"master","n":"span","l":"\nview = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"//depot/project1/main/... project1/...","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"       //depot/project2/mainline/... project2/...","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-branch-name","n":"code","l":" 允许你将在 Git 下显得笨重的仓库路径转换为更友好的名字。\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"view","n":"code","l":" 选项使用标准视图映射语法控制 Perforce 文件如何映射到 Git 仓库。\n可以指定一个以上的映射，就像下面的例子："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[Talkhouse-master]","n":"span","l":"\ngit-branch-name = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"master","n":"span","l":"\nview = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"//depot/Talkhouse/main-dev/... ...","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"repos/Talkhouse/p4gf_config","n":"code","l":"。\n如果打开这个文件，你会看到有一些与全局默认不同设置的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"[@repo]","n":"code","l":" 区块。\n你也会看到像下面这样的区块："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[repo-creation]","n":"span","l":"\ncharset = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"utf8","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[git-to-perforce]","n":"span","l":"\nchange-owner = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"author","n":"span","l":"\nenable-git-branch-creation = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"yes","n":"span","l":"\nenable-swarm-reviews = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"yes","n":"span","l":"\nenable-git-merge-commits = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"yes","n":"span","l":"\nenable-git-submodules = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"yes","n":"span","l":"\npreflight-commit = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"none","n":"span","l":"\nignore-author-permissions = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"no","n":"span","l":"\nread-permission-check = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"none","n":"span","l":"\ngit-merge-avoidance-after-change-num = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"12107","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[perforce-to-git]","n":"span","l":"\nhttp-url = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"none","n":"span","l":"\nssh-url = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"none","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[@features]","n":"span","l":"\nimports = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"False","n":"span","l":"\nchunked-push = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"False","n":"span","l":"\nmatrix2 = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"False","n":"span","l":"\nparallel-push = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"False","n":"span","l":"\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"[authentication]","n":"span","l":"\nemail-case-sensitivity = "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"no","n":"span"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"objects","n":"code","l":" 目录被 Git Fusion 内部用来双向映射 Perforce 对象与 Git 对象，你不必弄乱那儿的任何东西。\n在这个目录中有一个全局的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"p4gf_config","n":"code","l":" 文件，每个仓库中也会有一份 - 这些配置文件决定了 Git Fusion 的行为。\n让我们看一下根目录下的文件："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" tree\n.\n├── objects\n│   ├── repos\n│   │   └── [...]\n│   └── trees\n│       └── [...]\n│\n├── p4gf_config\n├── repos\n│   └── Talkhouse\n│       └── p4gf_config\n└── users\n    └── p4gf_usermap\n\n498 directories, 287 files"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"//.git-fusion","n":"code","l":" 目录到你的工作空间。\n文件结构看起来像这样："},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_设置_2"]],"x":"设置","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"针对我们的例子，我们将会使用最简单的方式安装 Git Fusion：下载一个虚拟机来运行 Perforce 守护进程与 Git Fusion。\n可以从 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在第一次启动机器后，它会询问你自定义三个 Linux 用户（","n":"p","l":"\n"},{"a":[["class","image pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"应当注意显示在这儿的 IP 地址，我们将会在后面用到。\n接下来，我们将会创建一个 Perforce 用户。\n选择底部的 “Login” 选项并按下回车（或者用 SSH 连接到这台机器），然后登录为 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"第一个命令将会打开一个 VI 编辑器来自定义用户，但是可以通过输入 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"接下来要做的事就是告诉 Git 不要验证 SSL 证书。\nGit Fusion 镜像内置一个证书，但是域名并不匹配你的虚拟主机的 IP 地址，所以 Git 会拒绝 HTTPS 连接。\n如果要进行永久安装，查阅 Perforce Git Fusion 手册来安装一个不同的证书；然而，对于我们这个例子来说，这已经足够了。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在我们可以测试所有东西是不是正常工作。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"虚拟机镜像自带一个可以克隆的样例项目。\n这里我们会使用之前创建的 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"john","n":"code","l":" 用户，通过 HTTPS 进行克隆；Git 询问此次连接的凭证，但是凭证缓存会允许我们跳过这步之后的任意后续请求。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git clone https://10.0.1.254/Talkhouse\nCloning into 'Talkhouse'...\nUsername for 'https://10.0.1.254': john\nPassword for 'https://john@10.0.1.254':\nremote: Counting objects: 630, done.\nremote: Compressing objects: 100% (581/581), done.\nremote: Total 630 (delta 172), reused 0 (delta 0)\nReceiving objects: 100% (630/630), 1.22 MiB | 0 bytes/s, done.\nResolving deltas: 100% (172/172), done.\nChecking connectivity... done."},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" export GIT_SSL_NO_VERIFY=true"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":":wq","n":"code","l":" 并回车来接受默认选项。\n第二个命令将会提示输入密码两次。\n这就是所有我们要通过终端提示符做的事情，所以现在可以退出当前会话了。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" p4 -p localhost:1666 -u super user -f john\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" p4 -p localhost:1666 -u john passwd\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" exit"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"root","n":"code","l":"。\n然后使用这些命令创建一个用户："},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre9 pcalibre1 pcalibre"]],"x":"Figure 1. Git Fusion 虚拟机启动屏幕。","n":"figcaption","l":"\n"},{"a":[["alt","Git Fusion 虚拟机启动屏幕。"],["class","calibre8 pcalibre1 pcalibre"],["src","ezPJKgrMLI5iYpd7vlZT7E|aW1hZ2VzLzAwMDEyLmpwZWc=|"],["data-calibre-src","images/00012.jpeg"]],"n":"img","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"root","n":"code","l":"、"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"perforce","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git","n":"code","l":"）的密码，并且提供一个实例名字来区分在同一网络下不同的安装。\n当那些都完成后，将会看到这样："},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","http://www.perforce.com/downloads/Perforce/20-User"],["target","_blank"],["rel","noopener noreferrer"]],"x":"http://www.perforce.com/downloads/Perforce/20-User","n":"a","l":" 获得虚拟机镜像，下载完成后将它导入到你最爱的虚拟机软件中（我们将会使用 VirtualBox）。"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","http://www.perforce.com/git-fusion"],["target","_blank"],["rel","noopener noreferrer"]],"x":"http://www.perforce.com/git-fusion","n":"a","l":" 获得），它将会在服务器这边同步 Perforce 服务器与 Git 仓库。"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","_git_与_mercurial"]],"x":"Git 与 Mercurial","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n\nDVCS 的宇宙里不只有 Git。\n实际上，在这个空间里有许多其他的系统。对于如何正确地进行分布式版本管理，每一个系统都有自己的视角。\n除了 Git，最流行的就是 Mercurial，并且它们两个在很多方面都很相似。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"好消息是，如果你更喜欢 Git 的客户端行为但是工作在源代码由 Mercurial 控制的项目中，有一种使用 Git 作为 Mercurial 托管仓库的客户端的方法。\n由于 Git 与服务器仓库是使用远程交互的，那么由远程助手实现的桥接方法就不会让人很惊讶。\n这个项目的名字是 git-remote-hg，可以在 ","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","git-remote-hg"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","开始"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","工作流程"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","分支与书签"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Mercurial 总结"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_mercurial_总结"]],"x":"Mercurial 总结","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 与 Mercurial 如此相似，以至于跨这两个系统进行工作十分流畅。\n如果能注意避免改变在你机器上的历史（就像通常建议的那样），你甚至并不会察觉到另一端是 Mercurial。","n":"p","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_分支与书签"]],"x":"分支与书签","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 只有一种类型的分支：当提交生成时移动的一个引用。\n在 Mercurial 中，这种类型的引用叫作 “bookmark”，它的行为非常类似于 Git 分支。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Mercurial 的 “branch” 概念则更重量级一些。\n变更集生成时的分支会记录 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意开头为 “branch” 的那行。\nGit 无法真正地模拟这种行为（并且也不需要这样做；两种类型的分支都可以表达为 Git 的一个引用），但是 git-remote-hg 需要了解其中的区别，因为 Mercurial 关心。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"创建 Mercurial 书签与创建 Git 分支一样容易。\n在 Git 这边：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这就是所要做的全部。\n在 Mercurial 这边，它看起来像这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意在修订版本 5 上的新 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你也可以工作在一个 “重量级” 的 Mercurial branch：只需要在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"下面是 Mercurial 这边的样子：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"分支名字 “permanent” 记录在序号 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在 Git 这边，对于其中任何一种风格的分支的工作都是相同的：仅仅是正常做的检出、提交、抓取、合并、拉取与推送。\n还有需要知道的一件事情是 Mercurial 不支持重写历史，只允许添加历史。\n下面是我们的 Mercurial 仓库在交互式的变基与强制推送后的样子：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"变更集 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"8","n":"em","l":"、"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"9","n":"em","l":" 与 "},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"10","n":"em","l":" 已经被创建出来并且属于 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"permanent","n":"code","l":" 分支，但是旧的变更集依然在那里。\n这会让使用 Mercurial 的团队成员非常困惑，所以要避免这种行为。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg log --style compact -G\no  10[tip]   99611176cbc9   2014-08-14 20:21 -0700   ben\n|    A permanent change\n|\no  9   f23e12f939c3   2014-08-14 20:01 -0700   ben\n|    Add some documentation\n|\no  8:1   c16971d33922   2014-08-14 20:00 -0700   ben\n|    goodbye\n|\n| o  7:5   a4529d07aad4   2014-08-14 20:21 -0700   ben\n| |    A permanent change\n| |\n| | @  6   8f65e5e02793   2014-08-14 20:06 -0700   ben\n| |/     More documentation\n| |\n| o    5[featureA]:4,2   bd5ac26f11f9   2014-08-14 20:02 -0700   ben\n| |\\     Merge remote-tracking branch 'origin/master'\n| | |\n| | o  4   0434aaa6b91f   2014-08-14 20:01 -0700   ben\n| | |    update makefile\n| | |\n+---o  3:1   318914536c86   2014-08-14 20:00 -0700   ben\n| |      goodbye\n| |\n| o  2   f098c7f45c4f   2014-08-14 20:01 -0700   ben\n|/     Add some documentation\n|\no  1   82e55d328c8c   2005-08-26 01:21 -0700   mpm\n|    Create a makefile\n|\no  0   0a04b987be5a   2005-08-26 01:20 -0700   mpm\n     Create a standard \"hello, world\" program"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"7","n":"em","l":" 的变更集中。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg branches\npermanent                      7:a4529d07aad4\ndevelop                        6:8f65e5e02793\ndefault                        5:bd5ac26f11f9 (inactive)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg log -G\no  changeset:   7:a4529d07aad4\n|  branch:      permanent\n|  tag:         tip\n|  parent:      5:bd5ac26f11f9\n|  user:        Ben Straub <ben@straub.cc>\n|  date:        Thu Aug 14 20:21:09 2014 -0700\n|  summary:     A permanent change\n|\n| @  changeset:   6:8f65e5e02793\n|/   branch:      develop\n|    user:        Ben Straub <ben@straub.cc>\n|    date:        Thu Aug 14 20:06:38 2014 -0700\n|    summary:     More documentation\n|\no    changeset:   5:bd5ac26f11f9\n|\\   bookmark:    featureA\n| |  parent:      4:0434aaa6b91f\n| |  parent:      2:f098c7f45c4f\n| |  user:        Ben Straub <ben@straub.cc>\n| |  date:        Thu Aug 14 20:02:21 2014 -0700\n| |  summary:     Merge remote-tracking branch 'origin/master'\n[...]"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git checkout -b branches/permanent\nSwitched to a new branch 'branches/permanent'\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" vi Makefile\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git commit -am "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'A permanent change'","n":"span","l":"\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git push origin branches/permanent\nTo hg::/tmp/hello\n * [new branch]      branches/permanent -> branches/permanent"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"branches","n":"code","l":" 命名空间内创建一个分支："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"[featureA]","n":"code","l":" 标签。\n在 Git 这边这些看起来像是 Git 分支，除了一点：不能从 Git 这边删除书签（这是远程助手的一个限制）。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg bookmarks\n   featureA                  5:bd5ac26f11f9\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg log --style compact -G\n@  6[tip]   8f65e5e02793   2014-08-14 20:06 -0700   ben\n|    More documentation\n|\no    5[featureA]:4,2   bd5ac26f11f9   2014-08-14 20:02 -0700   ben\n|\\     Merge remote-tracking branch 'origin/master'\n| |\n| o  4   0434aaa6b91f   2014-08-14 20:01 -0700   ben\n| |    update makefile\n| |\n| o  3:1   318914536c86   2014-08-14 20:00 -0700   ben\n| |    goodbye\n| |\no |  2   f098c7f45c4f   2014-08-14 20:01 -0700   ben\n|/     Add some documentation\n|\no  1   82e55d328c8c   2005-08-26 01:21 -0700   mpm\n|    Create a makefile\n|\no  0   0a04b987be5a   2005-08-26 01:20 -0700   mpm\n     Create a standard \"hello, world\" program"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git checkout -b featureA\nSwitched to a new branch 'featureA'\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git push origin featureA\nTo hg::/tmp/hello\n * [new branch]      featureA -> featureA"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg log -l 1\nchangeset:   6:8f65e5e02793\nbranch:      develop\ntag:         tip\nuser:        Ben Straub <ben@straub.cc>\ndate:        Thu Aug 14 20:06:38 2014 -0700\nsummary:     More documentation"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"在变更集中","n":"em","l":"，意味着它会永远地存在于仓库历史中。\n这个例子描述了一个在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"develop","n":"code","l":" 分支上的提交："},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_工作流程"]],"x":"工作流程","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"假设我们已经做了一些工作并且在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"我们的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"因为使用了 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"完美。\n运行测试然后所有测试都通过了，所以我们准备将工作共享给团队的其他成员。","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"就是这样！\n如果你现在查看一下 Mercurial 仓库，你会发现这样实现了我们所期望的：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"序号 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"2","n":"em","l":" 的变更集是由 Mercurial 生成的，序号 "},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"3","n":"em","l":" 与序号 "},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"4","n":"em","l":" 的变更集是由 git-remote-hg 生成的，通过 Git 推送上来的提交。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg log -G --style compact\no    5[tip]:4,2   dc8fa4f932b8   2014-08-14 19:33 -0700   ben\n|\\     Merge remote-tracking branch 'origin/master'\n| |\n| o  4   64f27bcefc35   2014-08-14 19:27 -0700   ben\n| |    Update makefile\n| |\n| o  3:1   4256fc29598f   2014-08-14 19:27 -0700   ben\n| |    Goodbye\n| |\n@ |  2   7db0b4848b3c   2014-08-14 19:30 -0700   ben\n|/     Add some documentation\n|\no  1   82e55d328c8c   2005-08-26 01:21 -0700   mpm\n|    Create a makefile\n|\no  0   0a04b987be5a   2005-08-26 01:20 -0700   mpm\n     Create a standard \"hello, world\" program"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git push\nTo hg::/tmp/hello\n   df85e87..0c64627  master -> master"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git merge origin/master\nAuto-merging hello.c\nMerge made by the 'recursive' strategy.\n hello.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate\n*   0c64627 (HEAD, master) Merge remote-tracking branch 'origin/master'\n|\\\n| * df85e87 (origin/master, origin/branches/default, origin/HEAD, refs/hg/origin/branches/default, refs/hg/origin/bookmarks/master) Add some documentation\n* | ba04a2a Update makefile\n* | d25d16f Goodbye\n|/\n* ac7955c Create a makefile\n* 65bb417 Create a standard \"hello, world\" program"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"--all","n":"code","l":" 标记，我们看到被 git-remote-hg 内部使用的 “notes” 引用，但是可以忽略它们。\n剩下的部分是我们期望的；"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"origin/master","n":"code","l":" 已经前进了一次提交，同时我们的历史现在分叉了。\nMercurial 和我们本章中讨论的其他系统不一样，它能够处理合并，所以我们不需要做任何其他事情。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git fetch\nFrom hg::/tmp/hello\n   ac7955c..df85e87  master     -> origin/master\n   ac7955c..df85e87  branches/default -> origin/branches/default\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate --all\n* 7b07969 (refs/notes/hg) Notes for default\n* d4c1038 Notes for master\n* df85e87 (origin/master, origin/branches/default, origin/HEAD, refs/hg/origin/branches/default, refs/hg/origin/bookmarks/master) Add some documentation\n| * ba04a2a (HEAD, master) Update makefile\n| * d25d16f Goodbye\n|/\n* ac7955c Create a makefile\n* 65bb417 Create a standard \"hello, world\" program"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 分支领先 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"origin/master","n":"code","l":" 分支两个提交，但是那两个提交只存在于我们的本地机器中。\n让我们看看在同一时间有没有其他人做过什么重要的工作："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate\n* ba04a2a (HEAD, master) Update makefile\n* d25d16f Goodbye\n* ac7955c (origin/master, origin/branches/default, origin/HEAD, refs/hg/origin/branches/default, refs/hg/origin/bookmarks/master) Create a makefile\n* 65bb417 Create a standard \"hello, world\" program"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 分支做了几次提交，而且已经准备将它们推送到远程仓库。\n这是我们仓库现在的样子："},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_开始_2"]],"x":"开始","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"既然有一个可用的 “server-side” 仓库，我们可以通过一个典型的工作流来了解。\n你将会看到，这两种系统非常相似，没有太多的出入。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"和 Git 一样，首先我们克隆：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你会注意到与 Mercurial 仓库工作时使用了标准的 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"log 命令显示了两次提交，最后一次提交指向了一大堆引用。\n那说明这其中的一部分实际上并没有在那儿。\n让我们看看 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git-remote-hg 尝试让结构更有 Git 风格，但是在隐藏在下面的是它管理两个轻微不同系统之间概念的映射。\n","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"所以 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"好消息是大多数情况下我们不需要关心以上这些。\n典型的工作流程与使用 Git 远程仓库并没有什么不同。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在我们继续之前，这里还有一件需要注意的事情：忽略。\nMercurial 与 Git 使用非常类似的机制实现这个功能，但是一般来说你不会想要把一个 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".git/info/exclude","n":"code","l":" 文件的作用像是一个 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":"，但是它不包含在提交中。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cp .hgignore .git/info/exclude"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":" 文件提交到 Mercurial 仓库中。\n幸运的是，Git 有一种方式可以忽略本地磁盘仓库的文件，而且 Mercurial 格式是与 Git 兼容的，所以你只需将这个文件拷贝过去："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/notes/hg","n":"code","l":" 指向了一个树，即在 Git 对象数据库中的一个有其他对象名字的列表。\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git ls-tree","n":"code","l":" 输出 tree 对象中所有项目的模式、类型、对象哈希与文件名。\n如果深入挖掘 tree 对象中的一个项目，我们会发现在其中是一个名字为 “ac9117f” 的 blob 对象（"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 所指向提交的 SHA-1 散列值），包含内容 “0a04b98”（是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"default","n":"code","l":" 分支指向的 Mercurial 变更集的 ID）。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cat notes/hg\nd4c10386...\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git cat-file -p d4c10386...\ntree 1781c96...\nauthor remote-hg <> 1408066400 -0800\ncommitter remote-hg <> 1408066400 -0800\n\nNotes for master\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git ls-tree 1781c96...\n100644 blob ac9117f...\t65bb417...\n100644 blob 485e178...\tac7955c...\n\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git cat-file -p ac9117f\n0a04b987be5ae354b710cefeba0e2d9de7ad41a9"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"notes/hg","n":"code","l":" 文件是 git-remote-hg 如何在 Git 的提交散列与 Mercurial 变更集 ID 之间建立映射的起点。\n让我们来探索一下："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/hg","n":"code","l":" 目录中存储了实际的远程引用。\n例如，"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/hg/origin/branches/default","n":"code","l":" 是一个包含以`‘ac7955c’'开始的 SHA-1 值的 Git 引用文件，是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 所指向的提交。\n所以 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/hg","n":"code","l":" 目录是一种类似 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/remotes/origin","n":"code","l":" 的替代品，但是它引入了书签与分支的区别。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" tree .git/refs\n.git/refs\n├── heads\n│   └── master\n├── hg\n│   └── origin\n│       ├── bookmarks\n│       │   └── master\n│       └── branches\n│           └── default\n├── notes\n│   └── hg\n├── remotes\n│   └── origin\n│       └── HEAD\n└── tags\n\n9 directories, 5 files"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".git","n":"code","l":" 目录中实际上有什么："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git clone","n":"code","l":" 命令。\n那是因为 git-remote-hg 工作在相当低的底层，使用类似于 Git HTTP/S 协议的机制实现的（远程助手）。\n由于 Git 与 Mercurial 都设计为每一个客户端有一个仓库的完整历史，所以这个命令做了一次完整的克隆，包括所有的项目历史，并且相当快地完成。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git clone hg::/tmp/hello /tmp/hello-git\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cd /tmp/hello-git\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log --oneline --graph --decorate\n* ac7955c (HEAD, origin/master, origin/branches/default, origin/HEAD, refs/hg/origin/branches/default, refs/hg/origin/bookmarks/master, master) Create a makefile\n* 65bb417 Create a standard \"hello, world\" program"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_remote_hg"]],"x":"git-remote-hg","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"首先，需要安装 git-remote-hg。\n实际上需要将它的文件放在 PATH 变量的某个目录中，像这样：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"假定 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"（如果未安装 Python，访问 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"需要做的最后一件事是安装 Mercurial 客户端。\n如果还没有安装的话请访问 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在已经准备好摇滚了。\n你所需要的一切就是一个你可以推送的 Mercurial 仓库。\n很幸运，每一个 Mercurial 仓库都可以这样做，所以我们只需要使用大家用来学习 Mercurial 的“hello world”仓库就可以了：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" hg clone http://selenic.com/repo/hello /tmp/hello"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","http://mercurial.selenic.com/"],["target","_blank"],["rel","noopener noreferrer"]],"x":"http://mercurial.selenic.com/","n":"a","l":" 来安装。"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","https://www.python.org/"],["target","_blank"],["rel","noopener noreferrer"]],"x":"https://www.python.org/","n":"a","l":" 来获取它。）"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" pip install mercurial"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"~/bin","n":"code","l":" 在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"$PATH","n":"code","l":" 变量中。\nGit-remote-hg 有一个其他的依赖："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"mercurial","n":"code","l":" Python 库。\n如果已经安装了 Python，安装它就像这样简单："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" curl -o ~/bin/git-remote-hg "},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"\\","n":"span","l":"\n  https://raw.githubusercontent.com/felipec/git-remote-hg/master/git-remote-hg\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" chmod +x ~/bin/git-remote-hg"},{"a":[["class","link pcalibre5 pcalibre4 pcalibre3 pcalibre2 pcalibre1 pcalibre"],["href","https://github.com/felipec/git-remote-hg"],["target","_blank"],["rel","noopener noreferrer"]],"x":"https://github.com/felipec/git-remote-hg","n":"a","l":" 找到。"},{"a":[["class","pcalibre1 calibre7 pcalibre"],["id","r_git_svn"]],"x":"Git 与 Subversion","n":"h3","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\n很大一部分开源项目与相当多的企业项目使用 Subversion 来管理它们的源代码。\n而且在大多数时间里，它已经是开源项目VCS选择的 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"\nGit 中最棒的特性就是有一个与 Subversion 的双向桥接，它被称作 ","n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","git svn"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","设置"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","开始"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","提交回 Subversion"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","拉取新改动"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git 分支问题"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Subversion 分支"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","创建一个新的 SVN 分支"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","切换活动分支"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Subversion 命令"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","Git-Svn 总结"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_svn_总结"]],"x":"Git-Svn 总结","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"当你不得不使用 Subversion 服务器或者其他必须运行一个 Subversion 服务器的开发环境时，","n":"p","l":"\n"},{"a":[["class","content pcalibre1 pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你遵守了那些准则，忍受用一个 Subversion 服务器来工作可以更容易些。\n然而，如果有可能迁移到一个真正的 Git 服务器，那么迁移过去能使你的团队获得更多好处。","n":"p","l":"\n"},{"a":[["class","calibre10 pcalibre1 pcalibre"]],"x":"\n","n":"ul","l":"\n"},{"a":[["class","pcalibre7 calibre11 pcalibre1"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre7 calibre11 pcalibre1"]],"x":"\n","n":"li","l":"\n"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"不要建立一个单独的 Git 服务器，也不要在 Git 服务器上协作。\n可以用一台 Git 服务器来帮助新来的开发者加速克隆，但是不要推送任何不包含 ","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-svn-id","n":"code","l":" 条目的东西。\n你可能会需要增加一个 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"pre-receive","n":"code","l":" 钩子来检查每一个提交信息是否包含 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-svn-id","n":"code","l":" 并且拒绝任何未包含的提交。"},{"a":[["class","pcalibre1 pcalibre principal"]],"x":"保持一个线性的 Git 历史，其中不能有 ","n":"span","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git merge","n":"code","l":" 生成的合并提交。\n把你在主线分支外开发的全部工作变基到主线分支；而不要合并入主线分支。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 工具很有用。\n你应该把它当做一个不完全的 Git，然而，你要是不用它的话，就会在做转换的过程中遇到很多麻烦的问题。\n为了不惹麻烦，尽量遵守这些准则："},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_subversion_命令"]],"x":"Subversion 命令","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","SVN 风格历史"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","SVN 注解"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","SVN 服务器信息"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","chapter pcalibre1 pcalibre"],["title","忽略 Subversion 所忽略的"]],"x":"\n","n":"section","l":"\n"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_忽略_subversion_所忽略的"]],"x":"忽略 Subversion 所忽略的","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果克隆一个在任意一处设置 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"第二个命令是 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这样，你就不会由于 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":" 文件而把项目弄乱。\n当你是 Subversion 团队中唯一的 Git 用户时这是一个好的选项，并且你的队友并不想要项目内存在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":" 文件。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn show-ignore > .git/info/exclude"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn show-ignore","n":"code","l":"，它会将你需要放在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":" 文件中的每行内容打印到标准输出，这样就可以将输出内容重定向到项目的例外文件中："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svn:ignore","n":"code","l":" 属性的 Subversion 仓库时，你也许会想要设置对应的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":" 文件，这样就不会意外的提交那些不该提交的文件。\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 有两个命令来帮助解决这个问题。\n第一个是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn create-ignore","n":"code","l":"，它会为你自动地创建对应的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":".gitignore","n":"code","l":" 文件，这样你的下次提交就能包含它们。"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_svn_服务器信息"]],"x":"SVN 服务器信息","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"可以通过运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这就像是在你上一次和 Subversion 服务器通讯时同步了之后，离线运行的 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"blame","n":"code","l":" 与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"log","n":"code","l":" 命令。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn info\nPath: .\nURL: https://schacon-test.googlecode.com/svn/trunk\nRepository Root: https://schacon-test.googlecode.com/svn\nRepository UUID: 4c93b258-373f-11de-be05-5f7a86268029\nRevision: 87\nNode Kind: directory\nSchedule: normal\nLast Changed Author: schacon\nLast Changed Rev: 87\nLast Changed Date: 2009-05-02 16:07:37 -0700 (Sat, 02 May 2009)"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn info","n":"code","l":" 得到与 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svn info","n":"code","l":" 相同种类的信息。"},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_svn_注解"]],"x":"SVN 注解","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"类似 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"重复一次，它并不显示你在 Git 中的本地提交，也不显示同一时间被推送到 Subversion 的其他提交。","n":"p","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn blame README.txt\n 2   temporal Protocol Buffers - Google's data interchange format\n 2   temporal Copyright 2008 Google Inc.\n 2   temporal http://code.google.com/apis/protocolbuffers/\n 2   temporal\n22   temporal C++ Installation - Unix\n22   temporal =======================\n 2   temporal\n79    schacon Committing in git-svn.\n78    schacon\n 2   temporal To build and install the C++ Protocol Buffer runtime and the Protocol\n 2   temporal Buffer compiler (protoc) execute the following:\n 2   temporal"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn log","n":"code","l":" 命令离线模拟了 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svn log","n":"code","l":" 命令，你可以认为 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn blame [FILE]","n":"code","l":" 离线模拟了 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svn annotate","n":"code","l":"。\n输出看起来像这样："},{"a":[["class","calibre32 pcalibre1 pcalibre"],["id","_svn_风格历史"]],"x":"SVN 风格历史","n":"h5","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你习惯于使用 Subversion 并且想要看 SVN 输出风格的提交历史，可以运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"关于 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn log","n":"code","l":"，有两件重要的事你应该知道。\n首先，它是离线工作的，并不像真正的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svn log","n":"code","l":" 命令，会向 Subversion 服务器询问数据。\n其次，它只会显示已经提交到 Subversion 服务器上的提交。\n还未 dcommit 的本地 Git 提交并不会显示；同样也不会显示这段时间中其他人推送到 Subversion 服务器上的提交。\n它更像是最后获取到的 Subversion 服务器上的提交状态。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn log\n------------------------------------------------------------------------\nr87 | schacon | 2014-05-02 16:07:37 -0700 (Sat, 02 May 2014) | 2 lines\n\nautogen change\n\n------------------------------------------------------------------------\nr86 | schacon | 2014-05-02 16:00:21 -0700 (Sat, 02 May 2014) | 2 lines\n\nMerge branch 'experiment'\n\n------------------------------------------------------------------------\nr85 | schacon | 2014-05-02 16:00:09 -0700 (Sat, 02 May 2014) | 2 lines\n\nupdated the changelog"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn log","n":"code","l":" 来查看 SVN 格式的提交历史："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 工具集通过提供很多功能与 Subversion 中那些相似的命令来帮助简化转移到 Git 的过程。\n下面是一些提供了 Subversion 中常用功能的命令。"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_切换活动分支"]],"x":"切换活动分支","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 通过查找在历史中 Subversion 分支的头部来指出你的提交将会到哪一个分支 - 应该只有一个，并且它应该是在当前分支历史中最后一个有 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果想要同时在不止一个分支上工作，可以通过在导入的那个分支的 Subversion 提交开始来设置本地分支 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在，如果想要将你的 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"记住尽管使用的是 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git merge","n":"code","l":" 来做这个操作，而且合并可能会比在 Subversion 中更容易一些（因为 Git 会为你自动地检测合适的合并基础），但这并不是一个普通的 Git 合并提交。\n你不得不将这个数据推送回一个 Subversion 服务器，Subversion 服务器不支持那些跟踪多个父结点的提交；所以，当推送完成后，它看起来会是一个将其他分支的所有提交压缩在一起的单独提交。\n在合并一个分支到另一个分支后，你并不能像 Git 中那样轻松地回到原来的分支继续工作。\n你运行的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":" 命令会将哪个分支被合并进来的信息抹掉，所以后续的合并基础计算会是错的 - dcommit 会使你的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git merge","n":"code","l":" 结果看起来像是运行了 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git merge --squash","n":"code","l":"。\n不幸的是，没有一个好的方式来避免这种情形 - Subversion 无法存储这个信息，所以当使用它做为服务器时你总是会被它的限制打垮。\n为了避免这些问题，应该在合并到主干后删除本地分支（本例中是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"opera","n":"code","l":"）。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"opera","n":"code","l":" 分支合并入 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"trunk","n":"code","l":"（你的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":" 分支），可以用一个正常的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git merge","n":"code","l":" 来这样做。\n但是你需要通过 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"-m","n":"code","l":" 来提供一个描述性的提交信息，否则合并信息会是没有用的 “Merge branch opera”。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git branch opera remotes/origin/opera"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":" 到特定的 Subversion 分支。\n如果想要一个可以单独在上面工作的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"opera","n":"code","l":" 分支，可以运行"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-svn-id","n":"code","l":" 的。"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_创建一个新的_svn_分支"]],"x":"创建一个新的 SVN 分支","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"要在 Subversion 中创建一个新分支，运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这与 Subversion 中的 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svn copy trunk branches/opera","n":"code","l":" 命令作用相同并且是在 Subversion 服务器中操作。\n需要重点注意的是它并不会检出到那个分支；如果你在这时提交，提交会进入服务器的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"trunk","n":"code","l":" 分支，而不是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"opera","n":"code","l":" 分支。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn branch opera\nCopying file:///tmp/test-svn/trunk at r90 to file:///tmp/test-svn/branches/opera...\nFound possible branch point: file:///tmp/test-svn/trunk => file:///tmp/test-svn/branches/opera, 90\nFound branch parent: (refs/remotes/origin/opera) cb522197870e61467473391799148f6721bcf9a0\nFollowing parent with do_switch\nSuccessfully followed parent\nr91 = f1b64a3855d3c8dd84ee0ef10fa89d27f1584302 (refs/remotes/origin/opera)"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn branch [branchname]","n":"code","l":"："},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_subversion_分支"]],"x":"Subversion 分支","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在 Subversion 中新建分支与在 Git 中新建分支并不相同；如果你能不用它，那最好就不要用。\n然而，你可以使用 git svn 在 Subversion 中创建分支并在分支上做提交。","n":"p","l":"\n"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_git_分支问题"]],"x":"Git 分支问题","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"当适应了 Git 的工作流程，你大概会想要创建特性分支，在上面做一些工作，然后将它们合并入主分支。\n如果你正通过 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"假设你的历史像下面这样：创建了一个 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在一个合并过历史提交的分支上 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"当其他人克隆那些工作时，他们只会看到一个被塞入了所有改动的合并提交，就像运行了 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git merge --squash","n":"code","l":"；他们无法看到修改从哪来或何时提交的信息。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":" 命令工作得很好，除了当你查看你的 Git 项目历史时，它并没有重写所有你在 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"experiment","n":"code","l":" 分支上所做的任意提交 - 相反，所有这些修改显示一个单独合并提交的 SVN 版本中。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn dcommit\nCommitting to file:///tmp/test-svn/trunk ...\n    M\tCHANGES.txt\nCommitted r89\n    M\tCHANGES.txt\nr89 = 89d492c884ea7c834353563d5d913c6adf933981 (refs/remotes/origin/trunk)\n    M\tCOPYING.txt\n    M\tINSTALL.txt\nCommitted r90\n    M\tINSTALL.txt\n    M\tCOPYING.txt\nr90 = cb522197870e61467473391799148f6721bcf9a0 (refs/remotes/origin/trunk)\nNo changes between 71af502c214ba13123992338569f4669877f55fd and refs/remotes/origin/trunk\nResetting to the latest refs/remotes/origin/trunk"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"experiment","n":"code","l":" 分支，做了两次提交，然后将它们合并回 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"master","n":"code","l":"。\n当 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":" 时，你看到输出是这样的："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 推送到一个 Subversion 服务器，你可能想要把你的工作变基到一个单独的分支上，而不是将分支合并到一起。\n比较喜欢变基的原因是因为 Subversion 有一个线性的历史并且无法像 Git 一样处理合并，所以 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 在将快照转换成 Subversion 提交时，只会保留第一父提交。"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_拉取新改动"]],"x":"拉取新改动","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"如果你和其他开发者一起工作，当在某一时刻你们其中之一推送时，另一人尝试推送修改会导致冲突。\n那次修改会被拒绝直到你合并他们的工作。\n在 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了解决这种情况，可以运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在，所有你的工作都已经在 Subversion 服务器的内容之上了，你就可以顺利地 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意，和 Git 需要你在推送前合并本地还没有的上游工作不同的是，","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"记住这一点很重要，因为结果是当你推送后项目的状态并不存在于你的电脑中。\n如果修改并未冲突但却是不兼容的，可能会引起一些难以诊断的问题。\n这与使用 Git 服务器并不同 - 在 Git 中，可以在发布前完全测试客户端系统的状态，然而在 SVN 中，你甚至不能立即确定在提交前与提交后的状态是相同的。","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"你也应该运行这个命令从 Subversion 服务器上拉取修改，即使你自己并不准备提交。\n可以运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"每隔一会儿运行 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn rebase","n":"code","l":" 确保你的代码始终是最新的。\n虽然需要保证当运行这个命令时工作目录是干净的。\n如果有本地的修改，在运行 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn rebase","n":"code","l":" 之前要么储藏你的工作要么做一次临时的提交，不然，当变基会导致合并冲突时，命令会终止。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn rebase\n    M\tautogen.sh\nr88 = c9c5f83c64bd755368784b444bc7a0216cc1e17b (refs/remotes/origin/trunk)\nFirst, rewinding head to replay your work on top of it...\nFast-forwarded master to refs/remotes/origin/trunk."},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn fetch","n":"code","l":" 来抓取新数据，但是 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn rebase","n":"code","l":" 会抓取并更新你本地的提交。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn dcommit\nCommitting to file:///tmp/test-svn/trunk ...\n    M\tconfigure.ac\nCommitted r87\n    M\tautogen.sh\nr86 = d8450bab8a77228a644b7dc0e95977ffc61adff7 (refs/remotes/origin/trunk)\n    M\tconfigure.ac\nr87 = f3653ea40cb4e26b6281cec102e35dcba1fe17c4 (refs/remotes/origin/trunk)\nW: a0253d06732169107aa020390d9fefd2b1d92806 and refs/remotes/origin/trunk differ, using rebase:\n:100755 100755 efa5a59965fbbb5b2b0a12890f1b351bb5493c18 e757b59a9439312d80d5d43bb65d4a7d0389ed6d M\tautogen.sh\nFirst, rewinding head to replay your work on top of it..."},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 只会在修改发生冲突时要求你那样做（更像是 Subversion 工作的行为）。\n如果其他人推送一个文件的修改然后你推送了另一个文件的修改，你的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":" 命令会正常工作："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn dcommit\nCommitting to file:///tmp/test-svn/trunk ...\n    M\tREADME.txt\nCommitted r85\n    M\tREADME.txt\nr85 = 9c29704cc0bbbed7bd58160cfb66cb9191835cd8 (refs/remotes/origin/trunk)\nNo changes between 5762f56732a958d6cfda681b661d2a239cc53ef5 and refs/remotes/origin/trunk\nResetting to the latest refs/remotes/origin/trunk"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":"："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn rebase\nCommitting to file:///tmp/test-svn/trunk ...\n\nERROR from SVN:\nTransaction is out of date: File '/trunk/README.txt' is out of date\nW: eaa029d99f87c5c822c5c29039d19111ff32ef46 and refs/remotes/origin/trunk differ, using rebase:\n:100644 100644 65536c6e30d263495c17d781962cfff12422693a b34372b25ccf4945fe5658fa381b075045e7702a M\tREADME.txt\nFirst, rewinding head to replay your work on top of it...\nApplying: update foo\nUsing index info to reconstruct a base tree...\nM\tREADME.txt\nFalling back to patching base and 3-way merge...\nAuto-merging README.txt\nERROR: Not all changes have been committed into SVN, however the committed\nones (if any) seem to be successfully integrated into the working tree.\nPlease see the above messages for details."},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn rebase","n":"code","l":"，它会从服务器拉取任何你本地还没有的改动，并将你所有的工作变基到服务器的内容之上："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn dcommit\nCommitting to file:///tmp/test-svn/trunk ...\n\nERROR from SVN:\nTransaction is out of date: File '/trunk/README.txt' is out of date\nW: d5837c4b461b7c0e018b49d12398769d2bfc240a and refs/remotes/origin/trunk differ, using rebase:\n:100644 100644 f414c433af0fd6734428cf9d2a9fd8ba00ada145 c80b6127dd04f5fcda218730ddf3a2da4eb39138 M\tREADME.txt\nCurrent branch master is up to date.\nERROR: Not all changes have been committed into SVN, however the committed\nones (if any) seem to be successfully integrated into the working tree.\nPlease see the above messages for details."},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 中，它看起来是这样的："},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_提交回_subversion"]],"x":"提交回 Subversion","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在你有了一个工作仓库，你可以在项目上做一些改动，然后高效地使用 Git 作为 SVN 客户端将你的提交推送到上游。\n一旦编辑了一个文件并提交它，你就有了一个存在于本地 Git 仓库的提交，这提交在 Subversion 服务器上并不存在：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"接下来，你需要将改动推送到上游。\n注意这会怎样改变你使用 Subversion 的方式 - 你可以离线做几次提交然后一次性将它们推送到 Subversion 服务器。\n要推送到一个 Subversion 服务器，运行 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这会拿走你在 Subversion 服务器代码之上所做的所有提交，针对每一个做一个 Subversion 提交，然后重写你本地的 Git 提交来包含一个唯一的标识符。\n这很重要因为这意味着所有你的提交的 SHA-1 校验和都改变了。\n部分由于这个原因，同时使用一个基于 Git 的项目远程版本和一个 Subversion 服务器并不是一个好主意。\n如果你查看最后一次提交，有新的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意你原来提交的 SHA-1 校验和原来是以 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"4af61fd","n":"code","l":" 开头，而现在是以 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"95e0222","n":"code","l":" 开头。\n如果想要既推送到一个 Git 服务器又推送到一个 Subversion 服务器，必须先推送（"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"dcommit","n":"code","l":"）到 Subversion 服务器，因为这个操作会改变你的提交数据。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git log -1\ncommit 95e0222ba6399739834380eb10afcd73e0670bc5\nAuthor: ben <ben@0b684db3-b064-4277-89d1-21af03df0a68>\nDate:   Thu Jul 24 03:08:36 2014 +0000\n\n    Adding git-svn instructions to the README\n\n    git-svn-id: file:///tmp/test-svn/trunk@77 0b684db3-b064-4277-89d1-21af03df0a68"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git-svn-id","n":"code","l":" 被添加："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn dcommit\nCommitting to file:///tmp/test-svn/trunk ...\n    M\tREADME.txt\nCommitted r77\n    M\tREADME.txt\nr77 = 95e0222ba6399739834380eb10afcd73e0670bc5 (refs/remotes/origin/trunk)\nNo changes between 4af61fd05045e07598c553167e0f31c84fd6ffe1 and refs/remotes/origin/trunk\nResetting to the latest refs/remotes/origin/trunk"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn dcommit","n":"code","l":" 命令："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git commit -am "},{"a":[["class","pcalibre1 pcalibre calibre17"]],"x":"'Adding git-svn instructions to the README'","n":"span","l":"\n[master 4af61fd] Adding git-svn instructions to the README\n 1 file changed, 5 insertions(+)"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_开始"]],"x":"开始","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"既然已经有了一个有写入权限的 Subversion 仓库，那么你可以开始一个典型的工作流程。\n可以从 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这相当于运行了两个命令 - ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"至此，应该得到了一个已经导入了分支与标签的有效的 Git 仓库：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"注意这个工具是如何将 Subversion 标签作为远程引用来管理的。\n\n让我们近距离看一下 Git 的底层命令 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 在从 Git 服务器克隆时并不这样做；下面是在刚刚克隆完成的有标签的仓库的样子：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"Git 直接将标签抓取至 ","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"refs/tags","n":"code","l":"，而不是将它们看作分支。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git show-ref\nc3dcbe8488c6240392e8a5d7553bbffcb0f94ef0 refs/remotes/origin/master\n32ef1d1c7cc8c603ab78416262cc421b80a8c2df refs/remotes/origin/branch-1\n75f703a3580a9b81ead89fe1138e6da858c5ba18 refs/remotes/origin/branch-2\n23f8588dde934e8f33c263c6d8359b2ae095f863 refs/tags/v0.1.0\n7064938bd5e7ef47bfd79a685a62c1e2649e2ce7 refs/tags/v0.2.0\n6dcb09b5b57875f334f61aebed695e2e4193db5e refs/tags/v1.0.0"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git show-ref\n556a3e1e7ad1fde0a32823fc7e4d046bcfd86dae refs/heads/master\n0fb585761df569eaecd8146c71e58d70147460a2 refs/remotes/origin/my-calc-branch\nbfd2d79303166789fc73af4046651a4b35c12f0b refs/remotes/origin/tags/2.0.2\n285c2b2e36e467dd4d91c8e3c0c0e1750b3fe8ca refs/remotes/origin/tags/release-2.0.1\ncbda99cb45d9abcb9793db1d4f70ae562a969f1e refs/remotes/origin/tags/release-2.0.2\na9f074aa89e826d6f9d30808ce5ae3ffe711feda refs/remotes/origin/tags/release-2.0.2rc1\n556a3e1e7ad1fde0a32823fc7e4d046bcfd86dae refs/remotes/origin/trunk"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"show-ref","n":"code","l":"："},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git branch -a\n* master\n  remotes/origin/my-calc-branch\n  remotes/origin/tags/2.0.2\n  remotes/origin/tags/release-2.0.1\n  remotes/origin/tags/release-2.0.2\n  remotes/origin/tags/release-2.0.2rc1\n  remotes/origin/trunk"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn clone file:///tmp/test-svn -s"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"-T trunk -b branches -t tags","n":"code","l":" 部分告诉 Git Subversion 仓库遵循基本的分支与标签惯例。\n如果你命名了不同的主干、分支或标签，可以修改这些参数。\n因为这是如此地常见，所以能用 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"-s","n":"code","l":" 来替代整个这部分，这表示标准布局并且指代所有那些选项。\n下面的命令是相同的："},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn init","n":"code","l":" 以及紧接着的 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn fetch","n":"code","l":" - 你提供的 URL 。\n这会花费一些时间。\n测试项目只有 75 个左右的提交并且代码库并不是很大，但是 Git 必须一次一个地检出一个版本同时单独地提交它。\n对于有成百上千个提交的项目，这真的可能会花费几小时甚至几天来完成。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" git svn clone file:///tmp/test-svn -T trunk -b branches -t tags\nInitialized empty Git repository in /private/tmp/progit/test-svn/.git/\nr1 = dcbfb5891860124cc2e8cc616cded42624897125 (refs/remotes/origin/trunk)\n    A\tm4/acx_pthread.m4\n    A\tm4/stl_hash.m4\n    A\tjava/src/test/java/com/google/protobuf/UnknownFieldSetTest.java\n    A\tjava/src/test/java/com/google/protobuf/WireFormatTest.java\n…\nr75 = 556a3e1e7ad1fde0a32823fc7e4d046bcfd86dae (refs/remotes/origin/trunk)\nFound possible branch point: file:///tmp/test-svn/trunk => file:///tmp/test-svn/branches/my-calc-branch, 75\nFound branch parent: (refs/remotes/origin/my-calc-branch) 556a3e1e7ad1fde0a32823fc7e4d046bcfd86dae\nFollowing parent with do_switch\nSuccessfully followed parent\nr76 = 0fb585761df569eaecd8146c71e58d70147460a2 (refs/remotes/origin/my-calc-branch)\nChecked out HEAD:\n  file:///tmp/test-svn/trunk r75"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn clone","n":"code","l":" 命令开始，它会将整个 Subversion 仓库导入到一个本地 Git 仓库。\n需要牢记的一点是如果是从一个真正托管的 Subversion 仓库中导入，需要将 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"file:///tmp/test-svn","n":"code","l":" 替换为你的 Subversion 仓库的 URL："},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_设置"]],"x":"设置","n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"为了演示这个功能，需要一个有写入权限的典型 SVN 仓库。\n如果想要拷贝这些例子，你必须获得一份我的测试仓库的可写拷贝。\n为了轻松地拷贝，可以使用 Subversion 自带的一个名为 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"接下来，你需要先创建一个新的本地 Subversion 仓库：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"然后，允许所有用户改变版本属性 - 最容易的方式是添加一个返回值为 0 的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"现在可以调用加入目标与来源仓库参数的 ","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"这样就设置好了同步所使用的属性。\n可以通过运行下面的命令来克隆代码：","n":"p","l":"\n"},{"a":[["class","listing pcalibre1 pcalibre"]],"x":"\n","n":"figure","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"虽然这个操作可能只会花费几分钟，但如果你尝试拷贝原始的仓库到另一个非本地的远程仓库时，即使只有不到 100 个的提交，这个过程也可能会花费将近一个小时。\nSubversion 必须一次复制一个版本然后推送回另一个仓库 - 这低效得可笑，但却是做这件事唯一简单的方式。","n":"p","l":"\n"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" svnsync sync file:///tmp/test-svn\nCommitted revision 1.\nCopied properties for revision 1.\nTransmitting file data .............................[...]\nCommitted revision 2.\nCopied properties for revision 2.\n[…]"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" svnsync init file:///tmp/test-svn "},{"a":[["class","pcalibre1 pcalibre calibre16"]],"x":"\\","n":"span","l":"\n  http://progit-example.googlecode.com/svn/"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svnsync init","n":"code","l":" 命令同步这个项目到本地的机器。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" cat /tmp/test-svn/hooks/pre-revprop-change\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"#","n":"span","l":"!/bin/sh\nexit 0;\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" chmod +x /tmp/test-svn/hooks/pre-revprop-change"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"pre-revprop-change","n":"code","l":" 脚本。"},{"a":[["class","source pcalibre1 pcalibre"]],"n":"pre","l":"\n"},{"a":[["class","calibre13 pcalibre1 pcalibre"]],"n":"code"},{"a":[["class","calibre14 pcalibre1 pcalibre"]],"n":"span"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" mkdir /tmp/test-svn\n"},{"a":[["class","pcalibre1 calibre15 pcalibre"]],"x":"$","n":"span","l":" svnadmin create /tmp/test-svn"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"svnsync","n":"code","l":" 的工具。\n为了这些测试，我们在 Google Code 上创建了一个 "},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"protobuf","n":"code","l":" 项目部分拷贝的新 Subversion 仓库。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"protobuf","n":"code","l":" 是一个将结构性数据编码用于网络传输的工具。"},{"a":[["class","calibre29 pcalibre1 pcalibre"],["id","_code_class_literal_git_svn_code"]],"n":"h4","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"在 Git 中所有 Subversion 桥接命令的基础命令是 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"需要特别注意的是当你使用 ","n":"p","l":"\n"},{"a":[["class","calibre3 pcalibre1 pcalibre"]],"x":"不要重写你的历史然后尝试再次推送，同时也不要推送到一个平行的 Git 仓库来与其他使用 Git 的开发者协作。\nSubversion 只能有一个线性的历史，弄乱它很容易。\n如果你在一个团队中工作，其中有一些人使用 SVN 而另一些人使用 Git，你需要确保每个人都使用 SVN 服务器来协作 - 这样做会省去很多麻烦。","n":"p","l":"\n"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":" 时，就是在与 Subversion 打交道，一个与 Git 完全不同的系统。\n尽管 "},{"a":[["class","calibre12 pcalibre1 pcalibre"]],"x":"可以","n":"strong","l":" 在本地新建分支与合并分支，但是你最好还是通过变基你的工作来保证你的历史尽可能是直线，并且避免做类似同时与 Git 远程服务器交互的事情。"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":"。\n它可以跟很多命令，所以我们会通过几个简单的工作流程来为你演示最常用的命令。"},{"a":[["class","literal2 pcalibre1 pcalibre"]],"x":"git svn","n":"code"},{"a":[["class","pcalibre1 pcalibre literal"]],"x":"git svn","n":"code","l":"。\n这个工具允许你使用 Git 作为连接到 Subversion 有效的客户端，这样你可以使用 Git 所有本地的功能然后如同正在本地使用 Subversion 一样推送到 Subversion 服务器。\n这意味着你可以在本地做新建分支与合并分支、使用暂存区、使用变基与拣选等等的事情，同时协作者还在继续使用他们黑暗又古老的方式。\n当你试图游说公司将基础设施修改为完全支持 Git 的过程中，一个好方法是将 Git 偷偷带入到公司环境，并帮助周围的开发者提升效率。\nSubversion 桥接就是进入 DVCS 世界的诱饵。"},{"a":[["class","pcalibre1 pcalibre calibre4"]],"x":"事实标准","n":"em","l":"。\n它在很多方面都与曾经是源代码管理世界的大人物的 CVS 相似。"},{"a":[["class","pcalibre1 chapter-header pcalibre"]],"x":"\n","n":"div","l":"\n"},{"a":[["class","chapter-title pcalibre1 pcalibre"]],"n":"h1","l":"\n"},{"a":[["class","subtitle pcalibre1 pcalibre"]],"n":"small"},{"a":[["class","calibre2 pcalibre1 pcalibre"]],"x":"Git","n":"b","l":" "},{"a":[["class","calibre2 pcalibre1 pcalibre"]],"x":"与其他系统","n":"b"},{"x":"Git 与其他系统","n":"title","l":"\n    "},{"a":[["type","text/javascript"]],"x":"\ndocument.addEventListener('DOMContentLoaded', function(event, reader) {\n  if (!(reader = navigator.epubReadingSystem)) {\n    if (navigator.userAgent.indexOf(' calibre/') >= 0) reader = { name: 'calibre-desktop' };\n    else if (window.parent == window || !(reader = window.parent.navigator.epubReadingSystem)) return;\n  }\n  document.body.setAttribute('class', reader.name.toLowerCase().replace(/ /g, '-'));\n});\n","n":"script","l":"\n    \n  "},{"a":[["href","ezPJKgrMLI5iYpd7vlZT7E|c3R5bGVzLzAwMDMuY3Nz|"],["rel","stylesheet"],["type","text/css"]],"n":"link","l":"\n"},{"a":[["href","ezPJKgrMLI5iYpd7vlZT7E|c3R5bGVzLzAwMDIuY3Nz|"],["rel","stylesheet"],["type","text/css"]],"n":"link","l":"\n"}]}